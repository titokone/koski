<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
      "http://www.w3.org/TR/REC-html40/loose.dtd">
<html lang="en">
<head>
  <title>Titokone user's manual</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <style type="text/css">
   .virhekuvaus { font-weight: bold; }
   .virhetoipuminen { padding-bottom: 1em; }
  </style>
</head>
<body>
<h1>The Titokone user's manual</h1>


<!-- OLLI: Laitoin yl‰otsikoille (h2) valmiiksi a name -ankkurit,
     jotta #-linkit toimivat. Lis‰ile ankkureita ja tunnuksia
     loogiseksi katsomallasi nime‰misperusteella sit‰ mukaa kun tulee
     tarpeen viitata aiempiin/tuleviin aliotsikoihin (kuten
     esimerkiksi esimerkkivirhetilanteessa, jonka kirjailin
     loppup‰‰h‰n). T‰m‰n kommentin voi poistaa lukemisen j‰lkeen. -->


<h2>Contents</h2>


<ol>
  <li><a href="#general">Overview</a></li>
  <li><a href="#asennus"> Titokoneen asennusohjeet</a></li>
  <li><a href="#doables">What you can do with the Titokone</a></li>
  <li><a href="#machinelanguage">The TTK-91 machine language</a></li>
  <li><a href="#extension">Extending and adjusting the system</a></li>
  <li><a href="#troubleshooting">Troubleshooting</a></li>
  <!-- <li><a href="hakemisto">Glossary</a></li> --> <!-- jos jaksaa ker‰t‰-->
</ol>


<h2><a name="general">1. Overview</a></h2> 


<p>
Titokone is an assembler simulator, which is intended to show how symbolic assembly language is executed
in a simple processor.


* kun kuvaillaan koodin‰kym‰‰, siin‰ pit‰‰ muistaa korostaa ett‰ muisti
on yhten‰inen alue vaikka siit‰ onkin eristetty osa koodialueeksi. Myˆs
maininta siit‰, ett‰ data-alueella symbolisella arvolla ei ole
merkityst‰ (ja ett‰ suurin osa komennoista on jonkinlaisia noppeja)
lienee hyv‰st‰.


* n‰pp‰inshortcutit, jahka varmistuvat, mukaan kuvauksiin.
</p>


<table>
<tr>


 <td valign=top>
<a href="manual1.html#gui" name="gui">
<img src="screenEnglish0.jpg" title="Basic view of the system" 
  alt="Basic view">
</a>
</td>


 <td>
<ol>
     <li> Menus </li>
     <br>
     <li> Code window </li>
     <br>
     <li> Status </li>
     <br>
     <li> Display </li>
     <br>
     <li> Keyboard input </li>
     <br>
     <li> Symbol table </li>
     <br>
     <li> Registers </li>
     <br>
     <li> Comments </li>
</ol>




</td>


</tr>
</table>


<br>

<!-- TITOKONEEN ASENNUS -->





<h2><a name="asennus">2 Titokoneen asennusohjeet</a></h3>
<br>
<p> Jos olet jo asentanut Titokoneen, siirry suoraan Titokoneen <a href="#toiminnot">toimintoihin</a>.</p>

<table cellspacing=10>
<tr>
<td>  
<img src="0.jpg" title="" alt="">
</td>
<td>
<h3> 2.1 Javan hakeminen ja asennus</h3>
</td>
</tr>
</table>

<p>
Titokone on Javalla toteutettu TTK-91-konekielisimulaattori. Tarvitset
sit‰ k‰ytt‰‰ksesi Javan virtuaalikoneen (v‰hint‰‰n version 1.4.2)
koneellesi. Javan virtuaalikoneen Sunin implementaation voi ladata
osoitteesta <a href="http://java.sun.com">http://java.sun.com</a>. Seuraa siell‰ annettuja
asennusohjeita.
</p>
<p>
Sunin Java-sivuilta on joskus hieman hankala lˆyt‰‰ hakemaansa. Jos
haluat asentaa pelk‰n virtuaalikoneen, haluat "JRE"-paketin, jos taas
haluat myˆs kehitysymp‰ristˆn tehd‰ksesi omia Java-ohjelmiasi (tai
esimerkiksi uusia k‰‰nnˆksi‰ Titokoneeseen), haluat todenn‰kˆisesti
"SDK"-pakkauksen. T‰t‰ kirjoitettaessa J2SE:n versiot 1.4.2, sek‰
SDK:n‰ ett‰ JRE:n‰ (2 on alustan j‰rjestysnumero, versionumero on
erikseen), voi ladata sivulta
<a href="http://java.sun.com/j2se/1.4.2/download.html">http://java.sun.com/j2se/1.4.2/download.html</a>. 
</p>
<p>
Huomaa, ett‰ Helsingin yliopiston tietojenk‰sittelytieteen laitoksella
on jo valmiiksi asennettuna Java SDK 1.4.2 (tai uudempi versio), joten
Javan asennus on vain tarpeen jos haluat k‰ytt‰‰ Titokonetta
esimerkiksi kotikoneellasi.
</p>



<table cellspacing=10>
<tr>
<td>  
<img src="0.jpg" title="" alt="">
</td>
<td>
<h3> 2.2 Titokoneen hakeminen </h3>
</td>
</tr>
</table>



<p>
Titokoneen voi hakea Tietokoneen toiminta -kurssin kotisivun
kautta. Sivut ovat t‰ll‰ hetkell‰ osoitteessa
<a href="http://www.cs.helsinki.fi/teemu.kerola/tito/">http://www.cs.helsinki.fi/teemu.kerola/tito/</a>. Voit joko hakea
suoraan JAR-paketin, joka sis‰lt‰‰ Titokoneen (titokone.jar), tai
ZIP-tiedoston, joka sis‰lt‰‰ JAR-paketin, hieman ohjeita ja
apuskriptej‰. 
</p>


<table cellspacing=10>
<tr>
<td>  
<img src="0.jpg" title="" alt="">
</td>
<td>
<h3> 2.3 Titokoneen asennus </h3>
</td>
</tr>
</table>

<p>
<b>
Pika-asennus (Windows, Linux, jne)
</b>
</p>

<p>
Jos JAR-paketit ovat sinulle jo tuttuja, riitt‰‰ jos haet
titokone.jar-tiedoston. (JAR on pakettitiedostomuoto; jos
Windowsissasi on p‰iv‰ntasainen versio WinZipist‰, se osannee myˆs
avata paketin jos n‰in haluat. Linuxissa komento jar avaa paketin,
ks. alla.) Sen kummempaa asennusta ei tarvita, voit ajaa jar-tiedoston
suoraan. Esimerkiksi Windowsissa sinun tarvitsee vain suorittaa
komento
<pre>java.exe -jar titokone.jar</pre>

hakemistossa, johon tallensit titokone.jar -paketin. Vastaavastaa ohjelman.
T‰h‰n menness‰ sinulla tulisi olla Java asennettuna ja suorituspolullasi.
</p>

<b>Melko nopea asennus Windowsissa</b>
<p>
Hae titokone.zip ja avaa paketti haluamaasi kohdehakemistoon. Paketti
luo avautuessaan alihakemiston titokone. Vaihda sitten t‰h‰n
alihakemistoon ja tuplaklikkaa titokone-nimist‰ BAT-tiedostoa (MS-DOS
Batch). Titokone.bat erottuu titokone.jar-tiedostosta ikoninsa
perusteella; titokone.jar n‰ytt‰‰ yleens‰ keltaiselta joltakin
ruuvipuristimessa, kun taas titokone.bat n‰ytt‰‰ enemm‰nkin
hammasrattaalta ohjelmaikkunassa. Titokone.sh, k‰ynnistyskripti
Linux-koneita varten, on todenn‰kˆisesti Windowsin tuntematon
tiedostotyyppi. 
</p>
<p>
Jos BAT-tiedostot eiv‰t en‰‰ toimi Windowsin versiossa MEGASUPERHYPER
(testasimme niit‰ Windows XP:hen asti), lienee siell‰ kuitenkin viel‰
tuki komennon 'java.exe -jar C:\polku\hakemistoon\titokone\titokone.jar' 
ajamiseksi k‰ynnistysvalikon kautta. Korvaa C:\polku\hakemistoon\titokone 
oikealla polulla, jolta titokone.jar lˆytyy.
</p>

<b> Melko nopea asennus Linuxissa</b>
<p>
Hae titokone.zip ja avaa se (esim. gunzip titokone.zip) valitsemassasi
kohdehakemistossa. (Paketti luo avautuessaan alihakemiston
'titokone'.) Ohjelman ajaaksesi avaa terminaali-ikkuna, vaihda
avautuneesta paketista luotuun titokone-hakemistoon ja aja komento
</p>
<pre>java -jar titokone.jar</pre>
<p>
Jos kirjoittaminen on rasittavaa, ZIP-paketissa on myˆs
titokone.sh-aloitusskripti. Voit uudelleennimet‰ skriptin haluamaasi
muotoon (esim. tk), jonka j‰lkeen riitt‰‰ pelkk‰ komento ./tk (tai,
jos et nime‰ tiedostoa uudelleen, ./titokone.sh). Skripti ei vaihda
tyˆhakemistoa, joten joko sinun tulee s‰ilytt‰‰ se samassa
hakemistossa titokone.jar-paketin kanssa tai muokata sit‰.
</p>

<b>Jar-paketin avaaminen (l‰hinn‰ jatkokehitt‰ji‰ kiinnostavaa)</b>
<p>
Halutessasi voit avata jar-paketin:
</p>
<pre>
  Windowsissa: Paketti on varmaankin helpointa avata k‰ytt‰m‰ll‰
               WinZipi‰ tai vastaavaa paketink‰sittelyohjelmaa.
	 
  Linuxissa: jar -xvf titokone.jar
</pre>
<p>
Jar-paketti sis‰lt‰‰ mm. l‰hdekooditiedostoja, esimerkiksi koska haluat lis‰t‰
uuden kielitiedoston (ks. mukana tuleva k‰yttˆohjeen k‰‰nnˆsten
lis‰ysohjeet), huomaa ett‰ luokkatiedostot ovat osa Java-pakettia
(tarkemmin ottaen kolmea pakettia).
K‰ynnist‰‰ksesi muokatun ohjelman vaihda paketin juurihakemistoon
(jossa 'fi'-alihakemisto on) ja aja seuraava komento:
</p>
<pre>
  Windowsissa: java.exe fi.hu.cs.titokone.Titokone
  
  Linuxissa: java fi.hu.cs.titokone.Titokone
</pre>
<p>
Luokkien javadocit ovat hakemistossa javadoc/. Jotta voit k‰‰nt‰‰
java-tiedostoja (esimerkiksi lis‰tess‰si uuden kielen), tarvitset
Javan SDK-pakkauksen, JRE ei t‰h‰n riit‰.
</p>
<br>
















<!-- OHJELMAN AVAAMINEN -->







<h2><a name="doables">3. What you can do with the Titokone</a></h2>



<table cellspacing=10>
<tr>
  <td align=center>
  <a name="avaa">
  <img src="1en.html" title="Open button" 
  alt="Open button">
  </a>
  </td>


<td>
  <h3>3.1 Opening a TTK-91 file</h3> 
</td>


</tr>
</table>
  
<br>


<table cellspacing=10>
<tr>
  
<td valign=top>


<img src="Fileopen.jpg" title="Open from menu" 
alt="Open from menu">


</td>
      
<td valign=top>
<p> 
  Open a new file pressing the <a href="1en.html">compile-icon</a> or
  choose File -->  Open from the menu. <a href="#file">File dialog</a> is opened.
</p>
</td>


</tr>
</table>


<table cellspacing=10>
<tr>
  
<td valign=top>
<a name="file">
<img src="File.jpg" title="File dialog" 
alt="File dialog">
</a>
</td>
<td valign=top>
<p>
File dialog shows the files of current directory by extension.




Tiedoston‰kym‰ n‰ytt‰‰ nykyhakemiston tiedostot valitun p‰‰tteen mukaan. 
N‰ytett‰v‰t tiedostotyypit erotellaan p‰‰tteen mukaan: k91-p‰‰te tarkoittaa l‰hdekooditiedostoa ja
b91-p‰‰te bin‰‰ritiedostoa.
</p>
<ul><li>
When file with k91-extension is opened, <a href="Sourcecode.html#gui">source code view</a> is shown.
Source code file has to be <a href="#compile">compiled</a> before <a href=#run>executing</a> the file.




Avattaessa k91-p‰‰tteinen tiedosto, avautuu <a href="manual_fi1.html#gui">l‰hdekoodin‰kym‰</a> ruudulle.
L‰hdekooditiedosto on <a href="#kaanna">k‰‰nnett‰v‰</a> ennen kuin se voidaan <a href="#aja">suorittaa</a>.
</li>
<br>
<li>
When file with b91-extension is opened, <a href="manual3.html#gui">runnable view</a> is shown.
Binary file is already in machine language form, so it can be <a href="#run">executed</a> immediately.


Avattaessa b91-p‰‰tteinen tiedosto, avautuu <a href="manual_fi3.html#gui">suoritusn‰kym‰</a> ruudulle.
Bin‰‰ritiedosto on valmiiksi konekielimuodossa, joten se voidaan <a href="#aja">suorittaa</a> ilman k‰‰nt‰mist‰.
</li>
</ul>
</td>
</tr>
</table>


<br>








<!-- LƒHDEKOODIN MUOKKAUS -->








<table cellspacing=3>
<tr>
<td>  
<img src="0.jpg" title="" 
alt="">
</td>
<td>
<a name="koodinmuokkaus">
<h3> 2.3. Modifying source code </h3>
</a>
</td>
</tr>
</table>


<p>Source code can be edited in Titokone: </p>
<p>L‰hdekoodia on mahdollista muokata Titokoneessa seuraavasti: </p>
<ul>
<li> Open a k91-file. Avataan k91-p‰‰tteinen tiedosto. </li>
<li> Doubleclick a line from the source with left mouse button, cursor appears on the line. Kaksoisklikataan l‰hdekoodin rivi‰ vasemmalla hiiren napilla, kursori ilmestyy riville. </li>
<li> Modify the line as you want. Kirjoitetaan riville muutokset. </li>
<li> Press enter to save changes. Vahvistetaan muutokset painamalla enteri‰. </li>
<li> Modified source is saved to original file. Tehdyt muutokset tallettuvat alkuper‰iseen tiedostoon. </li>
</ul>


 




  <!-- Voi olla k91 tai b91, viittaa vastaaviin 2.x-lukuihin -->


<br>








<!-- OHJELMAN KƒƒNTƒMINEN-->








    
  <table cellspacing=10>
  <tr>
  
  <td>
  <img src="2.jpg" title="Compile" 
  alt="Picture of compile button">
  </td>
  
  <td>
  <a name="compile">
  <h3>2.4 Compiling TTK-91-source<h3> <!-- Ja mahd. tekstin muokkaus -->
  </a>
  </td>
  
  </tr>
  </table>
      
  <table cellspacing=10>
  <tr>


  <td valign=top>
  <img src="Filecompile.jpg" title="Compile from menu" 
  alt="Picture of compile">
  </td>
  
  <td valign=top>
  <p>
  
  
  Titokoneen k‰‰nnˆs on kaksivaiheinen: ensin tehd‰‰n syntaksitarkistus ja luodaan symbolitaulu. Toisella kierroksella muodostetaan objektikoodi.
  K‰‰nt‰minen aloitetaan painamalla <a href="2.jpg">k‰‰nn‰-pikakuvaketta</a> tai valitsemalla valikosta Tiedosto --> K‰‰nn‰.
  K‰‰nt‰minen toteutetaan <a href="#kaannosasetukset">k‰‰nnˆsasetusten</a> mukaisesti.
  joko pys‰hdellen tai kerralla loppuun asti k‰‰nt‰en. 
  </p>
  </td>
  </tr>
  </table>
  
  <br>
  <a name="kaantajantoiminnot">
  <b>
  Functions during the compiling
  Toiminnot k‰‰nt‰misen aikana
  </b>
  </a>
  
  <table cellspacing=10>
  <tr>
   
  <td>
  <img src="4.jpg" title="Rewind" 
  alt="Picture of rewind button">
  </td>
  <td><p> K‰‰nt‰mist‰ voi suorittaa askel kerrallaan, edeten seuraavaan <a href=#kaannostapahtumat> tapahtumaan </a> asti. </p>
  </td>
  </tr>
  
  <tr>
  <td><img src="5.jpg" title="FF" 
  alt="Picture of FF-button">
  </td>
  
  <td><p> Halutessaan k‰ytt‰j‰ voi suorittaa k‰‰nnˆksen kerralla loppuun.</p>
  </td>
  </tr>
  
  <tr>
  <td><img src="6.jpg" title="STOP" 
  alt="Picture of stop-button">
  </td>
  <td>
  <p> K‰‰nnˆs voidaan pys‰ytt‰‰ painamalla stop-nappia.
  </td>
  </tr>
  </table>
  <br>
  <a name="kaannostapahtumat">
  <b> K‰‰nnˆksen tapahtumatyypit </b>
  </a>
  <p> Tapahtumatyypeill‰ tarkoitetaan k‰‰nt‰j‰n reagointia l‰hdekoodin sis‰ltˆˆn. Rivi‰ kommentoidaan tai riville pys‰hdyt‰‰n <a href=#kaannosasetukset>asetusten</a> mukaisesti.</p>
  <p> First round:</p>
  <ul>
  <li> Ei tapahtumaa: jos rivi alkaa kommenttimerkill‰ (;), on tyhj‰ tai sis‰lt‰‰ k‰skyn NOP </li>
  <li> Muuttujan m‰‰rittely: Jos rivilt‰ lˆytyy uusi muuttuja, se lis‰t‰‰n symbolitauluun. </li>
  <li> Muuttujan k‰ytt‰minen: Jos rivin komennossa k‰ytet‰‰n muuttujaa, muuttuja lis‰t‰‰n symbolitauluun jos se ei siell‰ viel‰ ole. </li>
  <li> Muistiviitteen lˆytyminen: Jos rivin alusta lˆytyy muistiviite,viite ja rivin numero lis‰t‰‰n symbolitauluun </li>
  <li> K‰‰nnˆksen virhetilanne: k‰‰nnˆs keskeytet‰‰n, virheest‰ ilmoitetaan k‰ytt‰j‰lle ja jatka-painikkeella palaudutaan l‰hdekoodin‰kym‰‰n. </li>
  <li> Ensimm‰isen k‰‰nnˆsvaiheen valmistuminen: onnistuneen ensimm‰isen kierroksen j‰lkeen <a href="manual_fi2.html#gui">objektikoodin‰kym‰</a> tuodaan esiin ja toinen kierros voi alkaa. </li> 
  </ul>
  <p> Second round: </p>
  <ul> 
  <li> Creating the object code: numerical form of current command is shown and shown in status bar. </li>
  <li> Objektikoodin luonti: koodiriville tuodaan k‰skyn konekieliesitys ja k‰sky n‰ytet‰‰n alapalkin tilatiedoissa. </li>
  <li> Toisen k‰‰nnˆsvaiheen valmistuminen: ohjelma <a href=#lataaminen>ladataan</a> muistiin.</li>
  </ul>
  <br>
  
  
  
  <!-- KƒƒNN÷SASETUKSET-->
  
  
  
  <table cellspacing=10>
  <tr>
  <td>  
  <img src="0.jpg" title="" 
  alt="">
  </td>
  <td>
  <a name="kaannosasetukset">
  <h3>2.5 K‰‰nnˆsasetukset </h3>
  </a>
  </td>
  </tr>
  </table>
  
  
  
  
  <table cellspacing=10>
  <tr>
  <td>
  <img src="Tiedostomuokkaakaannos.jpg" title="K‰‰nnˆsasetukset valikosta" 
  alt="K‰‰nnˆsasetukset valikosta">
  </td>
  <td valign=top>
  <p>
  K‰‰nnˆksen aikaisia asetuksia voi muuttaa valitsemalla valikosta Asetukset --> Muokkaa k‰‰nnˆsasetuksia.
  </p>
  </td>
  
  </tr>
  <tr>
  <td>
  
  <img src="Kaannosasetukset.jpg" title="K‰‰nnˆsasetukset" 
  alt="K‰‰nnˆsasetukset">
  
  </td>
  <td valign=top> 
  <p>
  K‰‰nnˆsasetuksilla voidaan vaikuttaa k‰‰nnˆksen etenemistapaan ja kommentointiin.
  </p>
  <ul>
  <li>Jos 'Pys‰yt‰ k‰‰nt‰minen kommentin ilmestyess‰' on valittuna, k‰‰nnˆs etenee askelittain. K‰‰nnˆs j‰‰ odottamaan k‰ytt‰j‰lt‰ seuraavaa <a
  href=#kaantajantoiminnot>toimintoa</a>.
  </li>
  <li>Jos 'N‰yt‰ lis‰kommentteja k‰‰nt‰misen kulusta' on valittuna, rivin k‰‰nt‰misest‰ ilmestyy lis‰kommentteja kommentti-ikkunaan.
  
  </ul>
    
  </td>
  
  </tr>
  </table>
  
  <br>
   
  
  
  
  
  <!-- OHJELMAN LATAAMINEN-->
  
  
  
  
  <table cellspacing=10>
  <tr>
  <td>  
  <img src="0.jpg" title="" 
  alt="">
  </td>
  <td>
  <h3><a name="lataaminen">2.6 TTK-91-ohjelman lataaminen</a></h3>
  </td>
  </tr>
  </table>
  
  
  <p> Ohjelman lataaminen tapahtuu automaattisesti </p>
  <ul>
  <li>K91-tiedoston <a href=#kaanna>k‰‰nt‰misen</a> valmistuessa.</li>
  <li>B91-tiedoston <a href=#avaa>avaamisen</a> yhteydess‰ </li>
  </ul>
  <br>
  
  <!-- BINƒƒRIN TALLETTAMINEN-->
  
   <table cellspacing=10>
  <tr>
  <td>  
  <img src="0.jpg" title="" 
  alt="">
  </td>
  <td>
  <h3>2.7 TTK-91-ohjelman bin‰‰rin tallentaminen</h3>
  </td>
  </tr>
  </table>
    <!-- Tapahtuu j‰lleen "automaattisesti". Tallentuu sinne miss‰ 
         l‰hdekoodikin, p‰‰tteell‰ .b91. -->
  <br>
  
  
   <!-- SUORITUS-->
  
  
    
  <table cellspacing=10>
  <tr>
  
  <td>  
  <a name="run">
  <img src="3.jpg" title="Suorita" 
  alt="Kuva suorita-painikkeesta">
  </td>
  </a>    
  
  <td>
  <h3> 2.8 TTK-91-ohjelman suoritus</h3> <!-- Ja uudelleensuoritus -->
  </td>
  
  </tr>
  </table>
     
  
  <table cellspacing=10>
  <tr>
  <td>  
  <img src="Tiedostoaja.jpg" title="Aja valikosta" 
  alt="Ohjelman suoritus valikosta">
  </td>
  <td valign=top> K91-tiedoston k‰‰nnˆksen tai b91-tiedoston avaamisen seurauksena ohjelma ladataan muistiin ja on valmis suoritettavaksi.<a href=manual_fi3.html#gui>
  Suoritusn‰kym‰ss‰</a> koodi-ikkuna on jaettu kahteen osaan, koodi- ja data-alueeseen. On kuitenkin syyt‰ huomioida, ett‰ titokoneen muisti on todellisuudessa yhten‰inen alue; muistialueen jako kahteen osaan on toteutettu k‰ytett‰vyyssyist‰. Suoritus aloitetaan painamalla  <a href="3.jpg">suorita-pikakuvaketta</a>  tai valitsemalla valikosta Tiedosto --> Aja. Suoritus toteutetaan <a href=#suoritusasetukset>suoritusasetusten</a> mukaisesti joko pys‰hdellen tai kerralla loppuun asti suorittaen. </td>
  
  </tr>
  </table>
  <br>
  
  <b> Toiminnot suorituksen aikana </b>
  
  <table cellspacing=10>
  <tr>
   
  <td>
  <img src="4.jpg" title="Kelaa" 
  alt="Kuva kelaa-painikkeesta">
  </td>
  <td><p> Ohjelman ajaminen voidaan tehd‰ rivi kerrallaan.</p>
  </td>
  </tr>
  
  <tr>
  <td><img src="5.jpg" title="FF" 
  alt="Kuva FF-painikkeesta">
  </td>
  
  <td><p> Halutessaan k‰ytt‰j‰ voi suorittaa ohjelman yhdell‰ napin painalluksella.</p>
  </td>
  </tr>
  
  <tr>
  <td><img src="6.jpg" title="STOP" 
  alt="Kuva stop-painikkeesta">
  </td>
  <td>
  <p> Suoritus voidaan pys‰ytt‰‰ painamalla stop-nappia.
  </td>
  </tr>
  </table>
  <br>
  
  
  
  
  
  <!-- SUORITUSASETUSTEN MUUTTAMINEN -->
  
  
  
  
  <table cellspacing=10>
  <tr>
  
  <td>  
  <a name="suoritusasetukset">
  <img src="0.jpg" title="" 
  alt="">
  </a>
  </td>
  <td>
  <h3>2.9 Suoritusasetukset </h3>
  </td>
  </tr>
  </table>
  
  
  <table cellspacing=10>
  <tr>
  <td>
  <img src="Suoritusvalikko.jpg" title="Valikko suorita" 
  alt="Suoritusasetukset valikosta">
  </td>
  <td valign=top>
  <p> Suoritusasetuksia p‰‰see vaihtamaan valitsemalla valikosta Asetukset --> Muuta suoritusasetuksia </p>
  
  </td>
  </tr>
  <tr>  
  <td rowspan=3>
  <img src="Suoritusasetukset.jpg" title="Suoritusasetukset" 
  alt="Suoritusasetukset">
  </td>
  <td>
  <p> Suoritusasetukset ovat melko pitk‰lti vastaavat <a href=#kaannosasetukset>k‰‰nnˆsasetusten</a> kanssa; lis‰toimintona on animointi.
  <ul>
  <li> ohjelmakoodia voidaan suorittaa rivi kerrallaan </li>
  <li> lis‰kommentteja voidaan n‰ytt‰‰ <a href="manual_fi3.html#gui">kommentti-ikkunassa(8)</a></li>
  <li> animointi-ikkuna voidaan kytke‰ p‰‰lle tai pois </li>
  </ul>
  </td>
  </tr>
  </table>
  
  <p> Suoritusasetuksia on mahdollista muuttaa myˆs suoraan pikakuvakkeista:</p>
  <table cellspacing=10>
  <tr>
  <td>
  <img src="7.jpg" title="Riveitt‰in suoritus" 
  alt="Riveitt‰in suoritus">
  </td>
  <td>
  <p>   Riveitt‰in suorituksen kytkeminen p‰‰lle tai pois. </p>
  </td> 
  </tr>
  <tr>
  <td>
  <img src="8.jpg" title="Suorituksen kommentointi" 
  alt="Suorituksen kommentointi">
  </td>
  <td>
  <p> Suorituksen lis‰kommentoinnin kytkeminen p‰‰lle tai pois. </p>
  </td>
  
  </tr>
  <tr>
  <td>
  <img src="9.jpg" title="Animointi" 
  alt="Animointi">
  </td>
  <td>
  <p> Animointi-ikkunan n‰ytt‰misen kytkeminen p‰‰lle tai pois. </p>
  </td>
  </tr>
  </table>
  <!---
  <table>
  <tr>
  <td>
  <img src="Animointi.jpg" title="Kuva animaattorista" 
  alt="Kuva animaattorista">
  </td>
  </tr>
  
  </table> -->
  
  
  
  <!-- MUISTIN TYHJENTƒMINEN -->
  
  <table cellspacing=10>
  <tr>
  
  <td>  
  <img src="0.jpg" title="" 
  alt="">
  </td>
  <td>
  <h3>2.10 Muistin tyhjent‰minen</h3> 
  </td>
  </tr>
  </table>
   
  <!-- Viimeist‰‰n t‰‰ll‰ maininta muistin pysymisest‰ samana ellei sit‰
       nollata. -->
  <table>
  <tr>
  
  <td>
  <img src="Tyhjennamuisti.jpg" title="Muistin tyhjent‰minen" 
  alt="Muistin tyhjent‰minen">
  </td>
  <td valign=top>
  <p> Titokoneen muistin voi tyhjent‰‰ valikosta valitsemalla <b>Tiedosto --> Tyhjenn‰ muisti</b>. Muistin tyhjent‰misen lis‰ksi toiminnolla voidaan tyhjent‰‰ l‰hdekoodin‰kym‰. 
  Jos toimintoa k‰ytet‰‰n k‰‰nnˆs- tai ajovaiheessa, kyseinen toiminto keskeytyy ja ruudulle palautetaan <a href=#gui>alkun‰kym‰</a>, jossa rekisterit, symbolitaulu ja
  koodin‰kym‰ on tyhjennetty. </p> 
  
  </td>
  
  </tr>
  </table>
  <br>
       
  <td>  
  <img src="0.jpg" title="" 
  alt="">
  </td>
  <td> 
  <h3>2.11 Muistin koon vaihtaminen</h3>
  </td>
  </tr>
  </table>
  
  <table>
  <tr>
  
  <td>
  <img src="Muisti.jpg" title="Muistin koon muuttaminen" 
  alt="Muistin koon vaihtaminen valikosta">
  </td>
  <td valign=top>
  <p> Titokoneen muistin kokoa on mahdollista muuttaa valitsemalla valikosta <b>Asetukset --> Aseta muistin koko</b>.
  Muistin kokovaihtoehtoja on kahdeksan erilaista 512 rivist‰ 65536 riviin asti. Kun uusi muistin koko asetetaan, koodin‰kym‰ tyhjennet‰‰n
  ja n‰kyville palautetaan <a href="manual_fi.html#gui">alkun‰kym‰</a>.</p>
  </p>
  </td>
  </tr>
  </table>
  
  
  
  <td>  
  <a name="kielenvaihto">
  <img src="0.jpg" title="" 
  alt="">
  </a>
  </td>
  <td>
  <h3>2.12 K‰yttˆliittym‰n kielen vaihtaminen</h3>
  </td>
  </tr>
  </table>
  
  <table>
  <tr>
  
  <td>
  <img src="Asetakieli.jpg" title="Kieliasetusten vaihtaminen" 
  alt="Kieliasetukset">
  </td>
  <td>
  <p>
  Titokoneen k‰yttˆliittym‰ss‰ on mahdollista vaihtaa kieliasetuksia. Kieli valitaan valikosta <b>Asetukset --> Aseta kieli</b>. Oletuskielin‰ on suomi ja englanti.
  Kielen voi vaihtaa suoraan lennosta, l‰hes riippumatta k‰yttˆliittym‰n muista toiminnoista. Myˆs <a href=#kielenlisays>uuden kielen lis‰‰minen</a> on mahdollista
  Jos k‰ytt‰j‰ on m‰‰ritellyt oman kielitiedoston, se haetaan valitsemalla valikosta <b> Asetukset --> Aseta kieli --> Valitse tiedostosta...</b>. T‰m‰n j‰lkeen
  k‰ytt‰j‰n on haettava luotu kielitiedosto ja avattava se. Jos kielitiedosto on oikeaa muotoa, kieli vaihtuu v‰littˆm‰sti. Jos tietyn tekstin k‰‰nnˆsvastine puuttuu
  kielitiedostosta, k‰ytet‰‰n k‰yttˆliittym‰ss‰ oletuskielt‰, englantia, kyseisen sanan kohdalla.
  
  </p>
  </td>
  </tr>
  </table>


 <!-- Jne, sopivassa j‰rjestyksess‰. -->


<h2><a name="konekieli">3. TTK-91-konekieli</a></h2>
<!-- T‰ss‰ voi mietti‰, haluaako toistaa tekstitiedoston speksin v‰h‰n 
     siistimm‰ss‰ formaatissa vaiko vain. Mietin, nyt p‰‰dyin t‰h‰n...
-->
<pre>
======================================================================
                   A SUMMARY OF TTK-91 COMMANDS
======================================================================


+--------------------------------------------------------------------+
¶  Operation code  ¶  Rj ¶ M ¶  Ri ¶      address part ADDR          ¶
¶  8 bits          ¶  3  ¶ 2 ¶  3  ¶         16 bits                 ¶
+--------------------------------------------------------------------+
31               24 23           16 15                               0


In the symbolic machine language, the commands are of the form


LABEL OPER Rj,M ADDR(Ri)


where  OPER    the symbolic name of the command
       Rj      the first operand (register R0..R7)
       M       addressing mode:
               =   immediate operand
                   direct addressing (empty, ie. not marked)
               @   indirect addressing
       ADDR    address part (memory address or constant value)
       Ri      possible index register (register R0..R7)        


If some part of a command has no meaning, it can be left out. It is 
possible to add a label (symbolic address) in front of a command. The 
label should consist of the letters A-÷, 0-9 and _, and contain at 
least one non-numerical character. Only the first 8 characters are
considered.


Almost all commands have the following forms available:


   OPER Rj,ADDR        direct memory addressing
   OPER Rj,=ADDR       immediate operand
   OPER Rj,@ADDR       indirect memory addressing
   OPER Rj,ADDR(Ri)    indexed addressing
   OPER Rj,=ADDR(Ri)   indexed immediate operand
   OPER Rj,@ADDR(Ri)   indexed indirect memory addressing      
   OPER Rj,Ri          direct register addressing


There are exceptions:


    STORE           The latter operand is always the target address;
                    it cannot be a register or a constant value.
    POP             The latter operand must always be a register.   
    JUMP COMMANDS   The latter operand is always the target address;
                    it cannot be a constant. In the jump commands which
                    look at the state register, the first operand is  
                    ignored.               
    NOP             The operands are ignored.  


======================================================================
         The symbolic commands of the TTK-91 machine language
======================================================================


Data transfer commands:


LOAD   Stores the value of the latter operand to the register Rj.
STORE  Stores the integer in Rj as the value of the latter operand.    
IN     Reads an integer from the device given as the latter operand 
       into the register Rj (eg. IN R1,=KBD to read from the keyboard).
OUT    Outputs the integer in the register Rj to the device given as 
       the latter operand (eg. OUT R1,=CRT to print to screen).


Arithmetic and logical commands:


The result of the calculation is stored in register Rj.


ADD    Adds the value of the latter operand to the integer in the
       register Rj.
SUB    Substracts the value of the latter operand from the integer in 
       the register Rj.
MUL    Multiplies the integer in the register Rj with the value of the
       latter operand.
DIV    Divides the integer in the register Rj with the value of the 
       latter operand, and stores the whole part in Rj.
MOD    Modulo divides the integer in the register Rj with the value of
       the latter operand, and stores the remainder in Rj.
AND    Boolean logic 'and' between Rj and the value of the latter operand.
OR     Boolean logic 'or' between Rj and the value of the latter operand.
XOR    Boolean logic 'exclusive or' between Rj and the value of the
       latter operand.
SHL    Shifts the bits of the register Rj left, with the number of
       shifts given by the value of the latter operand. Fills the
       right end with 0 bits.
SHR    Shifts the bits on the register Rj right, otherwise like SHL.
SHRA   Performs an arithmetic right shift; as in SHR, but fills the
       left end with copies of the leftmost bit, thus keeping negative
       numbers negative.


COMP   Compares the first operand with the second operand and stores
       the result in the status register SR's bits L=less, E=equal,
       G=greater. See eg. JLES.


Forking commands:


JUMP   An unconditional jump to the target address expressed by the
       second operand.


JNEG   Jump if negative. If Rj < 0, jumps to the address given as the
       second operand, otherwise continues with the next command.
JZER   Jump if zero,      ie. if Rj = 0
JPOS   Jump if positive,      if Rj > 0
JNNEG  Jump if not negative,  if Rj >= 0
JNZER  Jump if not zero,      if Rj <> 0
JNPOS  Jump if not positive,  if Rj <= 0


JLES   Jump if less - if the status register SR has its L bit set,
       jumps to the address given as the second operand, otherwise
       continues from the next command. Used together with the COMP 
       command.
JEQU   Jump if equal,      ie. if E bit is set in SR
JGRE   Jump if greater,        if G bit is set in SR
JNLES  Jump if not less,       if E or G bit is set in SR
JNEQU  Jump if not equal       if L or G bit is set in SR 
JNGRE  Jump if not greater     if L or E bit is set in SR


Stack commands:


The first operand of the command, the register Rj, points to the top
of the stack, ie. the topmost item in it. Usually, the register SP
(which is also R6) is used as the stack pointer.


PUSH   Increases the stack pointer Rj's value by one and stores the latter
       operand as the topmost item in the stack.


POP    Removes the topmost item in the stack and stores it as the  
       register Ri (the latter operand is always a register). Substracts
       one from the stack pointer Rj.           


PUSHR  Pushes the registers R0, R1, R2, R3, R4, R5 and R6 (SP) to the 
       stack, in this order. Before pushing each register, increases the
       stack pointer Rj's value by one.


POPR   Pops values to the registers R6 (SP), R5, R4, R3, R2, R1 and
       R0, in this order, from the stack. For each pop, first fetches
       the value from the top of the stack indicated by the register  
       Rj, and then substracts one from Rj.


Subroutine commands:


CALL   Call procedure. Moves the control (by manipulating the program 
       counter) to the address given by the latter operand. Stores the
       return address to the stack, with its top indicated by Rj.
EXIT   Returns from a procedure to the command following its call. The
       return address is found from the stack, the top of which Rj
       points to. The latter operand indicates the number of parameters
       passed to the subroutine in the call.


System calls:  


SVC    Supervisor call. Calls a service routine in the operating system.
       The first operand is Rj, indicating the top of the stack, the 
       latter operand gives the number identifying the service.
       Supervisor calls are special subroutine calls to predefined 
       procedures. Their code is invisible to the user, and is considered
       to be stored "outside" the memory space.


       Service identifiers:


       HALT : Stops the execution of the program.
       TIME : Gives the time of day. The stack should contain the 
              addresses to store the hour, minute and second values.
              Note their order!
       DATE : Gives the date. The stack should contain the addresses 
              to store the year, month and day values. Note their order!
       READ : Reads an integer from the keyboard. The stack should 
              contain the address to store the integer to.
       WRITE: Prints an integer to the screen. The stack should
              contain the value to print.


Other:


NOP    No operation. This command does nothing.


======================================================================
              The operation codes of the TTK-91 commands
======================================================================


   Command   Binary     Decimal  Hexadecimal   


   NOP       0000 0000     0        00            


   STORE     0000 0001     1        01
   LOAD      0000 0010     2        02
   IN        0000 0011     3        03
   OUT       0000 0100     4        04


   ADD       0001 0001    17        11
   SUB       0001 0010    18        12
   MUL       0001 0011    19        13
   DIV       0001 0100    20        14
   MOD       0001 0101    21        15


   AND       0001 0110    22        16
   OR        0001 0111    23        17
   XOR       0001 1000    24        18
   SHL       0001 1001    25        19
   SHR       0001 1010    26        1A
   SHRA      0001 1011    27        1B


   COMP      0001 1111    31        1F


   JUMP      0010 0000    32        20
   JNEG      0010 0001    33        21
   JZER      0010 0010    34        22
   JPOS      0010 0011    35        23
   JNNEG     0010 0100    36        24
   JNZER     0010 0101    37        25
   JNPOS     0010 0110    38        26


   JLES      0010 0111    39        27
   JEQU      0010 1000    40        28
   JGRE      0010 1001    41        29
   JNLES     0010 1010    42        2A
   JNEQU     0010 1011    43        2B
   JNGRE     0010 1100    44        2C


   CALL      0011 0001    49        31
   EXIT      0011 0010    50        32
   PUSH      0011 0011    51        33
   POP       0011 0100    52        34
   PUSHR     0011 0101    53        35
   POPR      0011 0110    54        36


   SVC       0111 0000   112        70


======================================================================
                Predefined symbols of the TTK-91 machine   
======================================================================


These symbols can be used without explicitly defining them in a 
TTK-91 program.


Symbol          Value
---------------------
CRT             0
KBD             1
STDIN           6
STDOUT          7
HALT            11
READ            12
WRITE           13
TIME            14
DATE            15






======================================================================
             Instructions to the compiler (fake commands)
======================================================================


The compiler instructions direct the program translating the symbolic
machine language to binary. They are NOT actual symbolic commands.


name EQU value


The alias command EQU defines a symbolic name for an integer
value. The symbol name can be used in the ADDR field of a command, in
which case it will be handled as 'value' written in its stead
would be.


name DC value


The memory allocation command DC (data constant) allocates one word of
memory for a constant, aliases 'name' with the constant's memory
address and stores 'value' in the allocated address in the
memory. 'Name' can then be used in a command's ADDR field as a
memory address.


name DS size


The memory allocation command DS (data segment) allocates an area of
memory, sized 'size' words. It aliases 'name' with the start address
of the memory area. 'Name' can then be used in a command's ADDR field
as a memory address. This instruction is used for allocating space for
global variables.


option DEF string


This special instruction changes options for simulating the file
system of a TTK-91 machine. 'String' should be an absolute directory 
path. Examples:
  STDIN DEF /home/myuser/ttk91/stdin
  STDOUT DEF C:\mydir\stdout


Available options are:
  STDIN   To set which file stdin data is read from.
  STODUT  To set which file stdout data is written to.
  HOME    To set the user's home directory for this application;
          unused in Titokone as the home directory is requested from
          the underlying operating system via the Java virtual machine.


The default files for the two first options are stdin and stdout in
the user's home directory.


</pre>


<h2><a name="extension">4. Extending and adjusting the system</a></h2>


  <h3>4.1 Asetustiedostot</h3>


  <h3>4.2 Uuden kielen tukeminen</h3>
<pre>
* oman k‰‰nnˆstiedoston valitsijan pit‰‰ varmistaa, ettei
k‰‰nnˆstiedostossa ole pakettim‰‰rett‰ - muuten sen avaaminen
ep‰onnistuu (fi.hu.cs.titokone.resources.Translationsia ei voi avata
tiedostosta, mutta pelk‰n Translationsin voi - mutta sen nimi riippuu
siit‰ onko itse java-tiedostossa 'package'-m‰‰re). Tekij‰ voi ottaa
k‰‰nnˆsten pohjaksi Translations.javan, jossa on ohjeita t‰h‰n; mallia
tiedoston saattamisesta k‰ytett‰v‰ksi kannattaa kuitenkin ottaa muista
k‰‰nnˆksist‰, t‰ss‰ tapauksessa Translations_fi.javasta.
</pre>




  <!-- Jne. -->


<h2><a name="troubleshooting">5. Troubleshooting</a></h2>


  <!-- Virheilmoituksia -->


  <!-- Oudot taustas‰ievirheet: yleisohje, jos levi‰‰, kokeile uudelleen. 
       Yleens‰ johtuvat kuun v‰‰r‰st‰ asennosta ja poistuvat toisella
       yrityksell‰. Pahoittelumme. -->




  <!-- N‰m‰ voi vaihtaa divist‰ esim. p:ksi jos v‰lej‰ ei tule riitt‰v‰sti. -->


  <div class="virhekuvaus">Kun ohjelma latautuu k‰‰nnˆksen tai ajon
  p‰‰ttymisen j‰lkeen, saan kommenttikentt‰‰n virheilmoituksen muotoa
  "STDIN-datatiedostoa ei voi lukea: /minun/hakemistoni/stdin (Joku
  syy)".</div>


  <div class="virhetoipuminen">Ohjelma ilmoittaa vain, ett‰ mik‰li
  tulevaisuudessa n‰ill‰ asetuksilla joku TTK-91-sovellus yritt‰‰
  lukea STDIN-laitteelta, luku ep‰onnistuu ellei jotain tehd‰
  asialle. "Joku syy" -osuus kertoo, mik‰ j‰rjestelm‰n antama
  virheilmoitus oli kun tiedostoa luettiin. Jos sovelluksesi tarvitsee
  STDIN-laitetta, korjaa tiedoston tilanne ja lataa sovellus
  uudelleen. Ks. myˆs <a href="#lataaminen">2.5, TTK-91-ohjelman
  lataaminen</a>.</div>
    
  <div class="virhekuvaus">On tyls‰‰.</div>


<pre>
* virheilmoitukset pit‰‰ k‰yd‰ l‰pi ja selvitt‰‰, mit‰ kukin tarkoittaa.
T‰t‰ pit‰nee tehd‰ osittain ryhm‰ss‰ tai ainakin kysellen.


---------------------
eka:
Puhuin viime kokouksessa, ett‰ olen ottanut GUIhin Look And Feel -jutut mukaan, mik‰ saisi GUI:n n‰ytt‰m‰‰n etenkin Windowsissa uskomattoman hyv‰lt‰. Harmittavasti olen kuitenkin tˆrm‰nnyt Javan 1.4.2 versiota riivaavaan bugiin, joka aiheuttaa yhden tietyn operaation aikana mahdollisesti Exceptionin ilman, ett‰ siihen voi itse vaikuttaa. Aluksi tuskailin kyseisen Exceptionin kanssa, kun en mill‰‰n ymm‰rt‰nyt ett‰ mist‰ sellainen voi tulla. Sitten ‰lysin katsastaa Googlesta parilla hyvin valitulla hakusanalla ja kappas vain, osoittautuikin ett‰ kyseess‰ on ihan raportoitu bugi. Bugin numero on 4711700 ja suora linkki raporttiin on http://developer.java.sun.com/developer/bugParade/bugs/4711700.html

Mahdollisesti bugin voi kiert‰‰ parilla lis‰rivill‰ koodia, mutta se maksaa silloin t‰llˆin pidemm‰ll‰ latausajalla enk‰ voi taata ett‰ ohjelma v‰ltt‰m‰tt‰ edes k‰ynnistyy joka kerta. Tosin, todenn‰kˆisyys sille on koneesta rippuen 1/100. Tulevissa Javan versioissa kyseist‰ ongelmaa ei tietenk‰‰n ole, sill‰ eikˆh‰n lˆydetyt bugit yleens‰ korjata.


Toinen mahdollisuus on, mik‰li Exception tulee, ilmoittaa pahoitellen, ett‰ ohjelma ei k‰ynnisty johtuen Javassa olevasta bugista ja pyydet‰‰n k‰ynnist‰m‰‰n uudelleen. Harvoin tuo kahta kertaa per‰kk‰in tulee. Mun mielest‰ kuitenkaan ei kannata tinki‰ siit‰ hienosta ulkon‰ˆst‰ jonkun typer‰n bugin vuoksi, joka tuskin vaivaa en‰‰ ainakaan syksyll‰, jolloin ohjelmaa oikeasti k‰ytet‰‰n.




ennen:
On Wed, 2004-08-18 at 11:10, Arto ≈kerlund wrote:
> Mahdollisesti bugin voi kiert‰‰ parilla lis‰rivill‰ koodia, mutta se
> maksaa silloin t‰llˆin pidemm‰ll‰ latausajalla enk‰ voi taata ett‰
> ohjelma v‰ltt‰m‰tt‰ edes k‰ynnistyy joka kerta. Tosin, todenn‰kˆisyys
> sille on koneesta rippuen 1/100. Tulevissa Javan versioissa kyseist‰
> ongelmaa ei tietenk‰‰n ole, sill‰ eikˆh‰n lˆydetyt bugit yleens‰
> korjata.


Hmm, laitetaan Titokoneeseen varmuuden vuoksi optio ton yli
hypp‰‰miseksi (jos parametrien joukossa on vaikka --disablelookandfeel,
ei tehd‰ lookandfeel-juttua), ja k‰ytet‰‰n workaroundia. Olli, laitatko
itsellesi ylˆs ett‰ kirjaat maininnan k‰yttˆohjeeseen?
------------------












On Sun, 2004-04-18 at 14:41, Olli Alm wrote:
> Ok, pist‰n korvan taakse tuon asian. Kuulostaa kyll‰
> hieman enemm‰n toteutusdokkarin kuin k‰yttˆohjeen asialta
> mielest‰ni. Mutta joo.


Siis k‰yttˆohjeeseen se menee muodossa "voit tˆrm‰t‰ t‰llaiseen
virheeseen, joka johtuu Javan 1.4.2-version bugista eik‰ yleens‰ toistu,
mutta tarvittaessa voit k‰ytt‰‰ --disablelooknfeel -parametri‰, jolloin
myˆs virhe poistuu". Toteutusdokkarissa voisi tietty mainita eri
parametrit joilla ohjelman voi k‰ynnist‰‰, mutta niille ei taida olla
juuri nyt j‰rkev‰‰ paikkaa.




-------------------
</pre>
  <div class="virhetoipuminen">Syˆ leip‰‰ ni ei o tyls‰‰. --Jukka Tilsa</div>






</body>
</html>
