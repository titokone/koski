<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
      "http://www.w3.org/TR/REC-html40/loose.dtd">
<html lang="en">
<head>
  <title>The Titokone user's manual</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <style type="text/css">
   .virhekuvaus { font-weight: bold; }
   .virhetoipuminen { padding-bottom: 1em; }
  </style>
</head>
<body>
<h1>The Titokone user's manual</h1>
<!-- P {font-family:"Verdana", serif}-->


<!-- OLLI: Laitoin yl‰otsikoille (h2) valmiiksi a name -ankkurit,
     jotta #-linkit toimivat. Lis‰ile ankkureita ja tunnuksia
     loogiseksi katsomallasi nime‰misperusteella sit‰ mukaa kun tulee
     tarpeen viitata aiempiin/tuleviin aliotsikoihin (kuten
     esimerkiksi esimerkkivirhetilanteessa, jonka kirjailin
     loppup‰‰h‰n). T‰m‰n kommentin voi poistaa lukemisen j‰lkeen. -->

<h2>Contents</h2>

<ol>
  <li><a href="#general">Overview</a></li>
  <li><a href="#install"> Installing Titokone</a></li>
  <li><a href="#doables">What you can do with the Titokone</a></li>
  <li><a href="#machinelanguage">The TTK-91 machine language</a></li>
  <li><a href="#extension">Extending and adjusting the system</a></li>
  <li><a href="#troubleshooting">Troubleshooting</a></li>
  <!-- <li><a href="hakemisto">Glossary</a></li> --> <!-- jos jaksaa ker‰t‰-->
</ol>

<h2><a name="general">1. Yleiskuva</a></h2> <!-- niinku t‰h? mik‰t‰‰on? -->

<p>
Titokone is an assembler simulator, which is intended to show how symbolic assembly language is executed
in a simple processor.

</p>

<table>
<tr>

<td>
<a href="manual1.html#gui" name="gui">
<img src="img/screenEnglish0.jpg" title="Basic view" 
  alt="Basic view of the system">
</a>
</td>

<td>
<ol>
     <li> Menus </li>
     <br>
     <li> Code window </li>
     <br>
     <li> Status </li>
     <br>
     <li> Display </li>
     <br>
     <li> Keyboard input </li>
     <br>
     <li> Symbol table </li>
     <br>
     <li> Registers </li>
     <br>
     <li> Comments </li>
</ol>


</td>

</tr>
</table>
<br>


<!-- Kuvaillaan k‰yttˆliittym‰n osat numeroittain: 1. valikot: hˆpˆhˆpˆ jne. -->
<!-- Kunkin selityksest‰ viitteit‰ kohtiin, joissa sit‰ k‰ytet‰‰n. -->




<!-- TITOKONEEN ASENNUS -->





<h2><a name="install">2 Installing Titokone</a></h3>
<br>
<p> Jos olet jo asentanut Titokoneen, siirry suoraan Titokoneen <a href="#doables">toimintoihin</a>.</p>

<table cellspacing=10>
<tr>
<td>  
<img src="img/0.jpg" title="" alt="">
</td>
<td>
<h3> 2.1 Getting and installing Java</h3>
</td>
</tr>
</table>

<p>
Titokone is a TTK-91 machine language simulator written in Java. To
run Titokone, you need a Java virtual machine (minimum version 1.4.2)
installed. You can download an implementation of the Java virtual
machine at <a href="http://java.sun.com">http://java.sun.com</a>. Follow their installation instructions.
</p>
<p>
It may be slightly difficult to find what you want at Sun's Java
pages. To install just the virtual machine, look for "JRE", to install
the development environment as well for making your own Java programs
or for creating new translations for Titokone, look for "SDK". At the
time of writing this, J2SE version 1.4.2, both SDK and JRE (the 2 is
the platform number, version number is different) could be downloaded
from
<a href="http://java.sun.com/j2se/1.4.2/download.html">http://java.sun.com/j2se/1.4.2/download.html</a>. 
</p>
<p>
Note that on the University of Helsinki, CS department, Java SDK 1.4.2
or newer has been installed already, so you only need to install Java
if you want to use Titokone at eg. your home machine.
</p>



<table cellspacing=10>
<tr>
<td>  
<img src="img/0.jpg" title="" alt="">
</td>
<td>
<h3> 2.2 Getting Titokone </h3>
</td>
</tr>
</table>



<p>
You can get Titokone via the Tietokoneen toiminta (Computer Organization) 
course homepage, currently at
<a href="http://www.cs.helsinki.fi/teemu.kerola/tito/">http://www.cs.helsinki.fi/teemu.kerola/tito/</a>. You can choose between downloading the JAR package containing Titokone(titokone.jar) directly or downloading a ZIP file which contains the
JAR file itself along with some instructions and helper programs. 
</p>


<table cellspacing=10>
<tr>
<td>  
<img src="img/0.jpg" title="" alt="">
</td>
<td>
<h3> 2.3 Installing Titokone </h3>
</td>
</tr>
</table>

<p>
<h4>
Quick installation (Windows, Linux, etc)
</h4>
</p>

<p>
For those who know how to manage JAR packages directly, fetching
titokone.jar is sufficient. (JAR is a package format; if you have an
up-to-date version of WinZip, you should be able to open them; in Linux,
use the command 'jar' - see below.) No installation is required; you can
run the jar file directly. For example, in Windows you must execute the
command
<pre>java.exe -jar titokone.jar</pre>

in the directory where you stored the titokone.jar package. 
In Linux, you must execute the command
</p>

<pre> java -jar titokone.jar </pre>
<p>
to run the program. You must have Java installed and on your execution
path. 
</p>


<h4>Almost-as-quick installation in Windows</h4>
<p>
Download titokone.zip and unpack it to the target directory of your
choosing. (The package creates a subdirectory called 'titokone'.) To
run Titokone, go to the subdirectory and double-click on the titokone
BAT (MS-DOS Batch) file. You can tell titokone.bat apart from the
titokone.jar file by its icon; titokone.jar usually looks like
something yellow in a screw bench, titokone.bat resembles a cog wheel
inside a window frame. Titokone.sh, a script which starts the program
in Linux, is probably an unknown filetype in Windows.
</p>
<p>
If BAT files have stopped working in Windows MEGAMILLIONSUPER (we have
tested them up to Windows XP), you can probably still somehow run the
command 'java.exe -jar C:\my\path\to\titokone\titokone.jar' via the
Start menu. Replace C:\my\path\to\titokone with the actual path to the
file.
</p>

<h4> Almost-as-quick installation in Linux</h4>
<p>
Download titokone.zip and unpack it (eg. gunzip titokone.zip) to the
target directory of your choosing. (The package creates a subdirectory
called 'titokone'.)  To run Titokone, open a terminal, change to the
directory the zip file opened, and then the 'titokone' subdirectory, 
and run
</p>
<pre>java -jar titokone.jar</pre>
<p>
If typing is tiresome, the zip contains a titokone.sh startup script
for your convenience. You can rename the file to something shorter, 
like tk. Then you just need to run ./tk (or ./titokone.sh if you have 
not renamed it). The script does not change directories, so you must 
either keep it in the same directory as titokone.jar or edit it.
</p>

<h4>Opening the jar (mostly interesting for developers only)</h4>
<p>
If you wish, you can open the jar by running the following command:
</p>
<pre>
  in Windows: It is probably easiest to open the file using WinZip or
              something similar.
  
  in Linux: jar -xvf titokone.jar
</pre>
<p>
The jar package contains the source code and class files, among other
things. If you modify the files, eg. to add a new language file (see the
included manual on how to do this), you should note that the class files
are a part of a Java package (three packages, to be exact).
</p>
<p>
To start the modified program, change to the package root directory (where
the 'fi' subdirectory is located) and run the command:
</p>
<pre>
  in Windows: java.exe fi.hu.cs.titokone.Titokone 
  
  in Linux: java fi.hu.cs.titokone.Titokone
</pre>
<p>
Javadoc of the classes is included in javadoc/. To compile files
(needed for eg. adding new language support), you need Java SDK, JRE
is not sufficient.
</p>
<br>



<!-- JƒRJESTELMƒN TOIMINNOT -->





<h2><a name="doables">3. J‰rjestelm‰n toiminnot</a></h2> <!-- mit‰ t‰ll‰ voi tehd‰? -->

<br>

<!-- OHJELMAN AVAAMINEN -->



<table cellspacing=10>
<tr>
  <td align=center>
  <a name="open">
  <img src="img/1.jpg" title="Open button" 
  alt="Picture of Open button">
  </a>
  </td>

<td>
  <h3>3.1 TTK-91-ohjelman avaaminen</h3> 
</td>

</tr>
</table>
  
<br>

<table cellspacing=10>
<tr>
  
<td valign=top>

<img src="img/Fileopen.jpg" title="Open file" 
alt="Open file from menu">

</td>
      
<td valign=top>
<p> 
  Uuden tiedoston avaaminen tapahtuu painamalla <a href="1en.html">avaa-pikakuvaketta</a> tai
  valitsemalla valikosta Tiedosto -->  Avaa. Valinnan seurauksena
  avautuu <a href="#file">tiedoston‰kym‰</a>.

</p>
</td>

</tr>
</table>

<table cellspacing=10>
<tr>
  
<td valign=top>
<a name="file">
<img src="img/File.jpg" title="File dialog" 
alt="Picture of file dialog">
</a>
</td>
<td valign=top>
<p>
Tiedoston‰kym‰ n‰ytt‰‰ nykyhakemiston tiedostot valitun p‰‰tteen mukaan. 
N‰ytett‰v‰t tiedostotyypit erotellaan p‰‰tteen mukaan: k91-p‰‰te tarkoittaa l‰hdekooditiedostoa ja
b91-p‰‰te bin‰‰ritiedostoa.
</p>
<ul><li>
Avattaessa k91-p‰‰tteinen tiedosto, avautuu <a href="Sourcecode.html">l‰hdekoodin‰kym‰</a> ruudulle.
L‰hdekooditiedosto on <a href="#compile">k‰‰nnett‰v‰</a> ennen kuin se voidaan <a href="#run">suorittaa</a>.
</li>
<br>
<li>
Avattaessa b91-p‰‰tteinen tiedosto, avautuu <a href="Running.html">suoritusn‰kym‰</a> ruudulle.
Bin‰‰ritiedosto on valmiiksi konekielimuodossa, joten se voidaan <a href="#run">suorittaa</a> ilman k‰‰nt‰mist‰.
</li>
</ul>
</td>
</tr>
</table>

<br>


<table cellspacing=10>
<tr>
  
<td valign=top>
<a name="file">
<img src="File.jpg" title="File dialog" 
alt="File dialog">
</a>
</td>
<td valign=top>
<p>
File dialog shows the files of current directory by extension. 
<!--*A*-->
The two possible types are identified by their ending: a .k91-extension is for the 
source code-file while .b91 is the ending for a compiled binary file.
</p>
<ul><li>
When file with k91-extension is opened, <a href="manual1.html#gui">source code view</a> is shown.
Source code file has to be <a href="#compile">compiled</a> before <a href=#run>executing</a> the file.


Avattaessa k91-p‰‰tteinen tiedosto, avautuu <a href="manual_fi1.html#gui">l‰hdekoodin‰kym‰</a> ruudulle.
L‰hdekooditiedosto on <a href="#kaanna">k‰‰nnett‰v‰</a> ennen kuin se voidaan <a href="#aja">suorittaa</a>.
</li>
<br>
<li>
When file with b91-extension is opened, <a href="manual3.html#gui">runnable view</a> is shown.
Binary file is already in machine language form, so it can be <a href="#run">executed</a> immediately.

<!-- Avattaessa b91-p‰‰tteinen tiedosto, avautuu <a href="manual_fi3.html#gui">suoritusn‰kym‰</a> 
ruudulle.
 Bin‰‰ritiedosto on valmiiksi konekielimuodossa, joten se voidaan <a href="#aja">suorittaa</a> 
ilman k‰‰nt‰mist‰.-->
</li>
</ul>
</td>
</tr>
</table>

<br>

<!-- LƒHDEKOODIN MUOKKAUS -->




<table cellspacing=3>
<tr>
<td>  
<img src="img/0.jpg" title="" 
alt="">
</td>
<td>
<a name="code-editing">
<h3> 3.2 L‰hdekoodin muokkaaminen </h3>
</a>
</td>
</tr>
</table>


<p>L‰hdekoodia on mahdollista muokata Titokoneessa seuraavasti: </p>
<ul>
<li> Avataan k91-p‰‰tteinen tiedosto. </li>
<p>joko</p>
<li> Napsautetaan l‰hdekoodin rivi‰ vasemmalla hiiren napilla, jolloin kursori ei ilmesty n‰kyviin, mutta riville voi kirjoittaa.</li>
<p><img src="img/this.jpg"></p>
<p>tai</p>
<li> Kaksoisnapsautetaan l‰hdekoodin rivi‰ vasemmalla hiiren napilla, kursori ilmestyy riville. </li>
<p><img src="img/orthis.jpg"></p>
<li> Kirjoitetaan riville muutokset. </li>
<li> Vahvistetaan muutokset painamalla enteri‰. </li>
<li> Tehdyt muutokset tallettuvat alkuper‰iseen tiedostoon. </li>
</ul>

 


  <!-- Voi olla k91 tai b91, viittaa vastaaviin 2.x-lukuihin -->

<br>




<!-- OHJELMAN KƒƒNTƒMINEN-->




    
  <table cellspacing=10>
  <tr>
  
  <td>
  <img src="img/2.jpg" title="Compile" 
  alt="Picture of compilebutton">
  </td>
  
  <td>
  <a name="compile">
  <h3>3.3 TTK-91-ohjelman k‰‰nt‰minen</h3> <!-- Ja mahd. tekstin muokkaus -->
  </a>
  </td>
  
  </tr>
  </table>
      
  <table cellspacing=10>
  <tr>

  <td valign=top>
  <img src="img/Filecompile.jpg" title="Compiling from menu" 
  alt="Picture of compiling menu">
  </td>
  
  <td valign=top>
  <p>
  Titokoneen k‰‰nnˆs on kaksivaiheinen: ensin tehd‰‰n syntaksitarkistus ja luodaan symbolitaulu. Toisella kierroksella muodostetaan objektikoodi.
  K‰‰nt‰minen aloitetaan painamalla <a href="2en.html">k‰‰nn‰-pikakuvaketta</a> tai valitsemalla valikosta Tiedosto --> K‰‰nn‰.
  K‰‰nt‰minen toteutetaan <a href="#compilesettings">k‰‰nnˆsasetusten</a> mukaisesti.
  joko pys‰hdellen tai kerralla loppuun asti k‰‰nt‰en. 
  </p>
  </td>
  </tr>
  </table>
  
  <br>
  <a name="compilingfunctions">
  <b>
  Toiminnot k‰‰nt‰misen aikana
  </b>
  </a>
  
  <table cellspacing=10>
  <tr>1 Javan hakemine
   
  <td>
  <img src="img/4.jpg" title="Forward" 
  alt="Picture of forward-button">
  </td>
  <td><p> Jatka askelittain: k‰‰nt‰mist‰ voi suorittaa askel kerrallaan, edeten seuraavaan <a href="#compcases">tapahtumaan</a> asti. </p>
  </td>
  </tr>
  
  <tr>
  <td><img src="img/5.jpg" title="FF" 
  alt="Picture of FF-button">
  </td>
  
  <td><p> Jatka: halutessaan k‰ytt‰j‰ voi suorittaa k‰‰nnˆksen kerralla loppuun.</p>
  </td>
  </tr>
  
  <tr>
  <td><img src="img/6.jpg" title="STOP" 
  alt="Picture of stop-button">
  </td>
  <td>
  <p> Pys‰yt‰: k‰‰nnˆs voidaan pys‰ytt‰‰ painamalla pys‰yt‰-nappia.
  </td>
  </tr>
  </table>
  <br>
  <a name="compcases">
  <b> K‰‰nnˆksen tapahtumatyypit </b>
  </a>
  <p> Tapahtumatyypeill‰ tarkoitetaan k‰‰nt‰j‰n reagointia l‰hdekoodin sis‰ltˆˆn. Rivi‰ kommentoidaan tai riville pys‰hdyt‰‰n <a href="#compilesettings">asetusten</a> mukaisesti.</p>
  <p> Ensimm‰inen kierros:</p>
  <ul>
  <li> Ei tapahtumaa: jos rivi alkaa kommenttimerkill‰ (;), on tyhj‰ tai sis‰lt‰‰ k‰skyn NOP </li>
  <li> Muuttujan m‰‰rittely: Jos rivilt‰ lˆytyy uusi muuttuja, se lis‰t‰‰n symbolitauluun. </li>
  <li> Muuttujan k‰ytt‰minen: Jos rivin komennossa k‰ytet‰‰n muuttujaa, muuttuja lis‰t‰‰n symbolitauluun jos se ei siell‰ viel‰ ole. </li>
  <li> Muistiviitteen lˆytyminen: Jos rivin alusta lˆytyy muistiviite, viite ja rivin numero lis‰t‰‰n symbolitauluun </li>
  <li> K‰‰nnˆksen virhetilanne: k‰‰nnˆs keskeytet‰‰n, virheest‰ ilmoitetaan k‰ytt‰j‰lle ja jatka-painikkeella palaudutaan l‰hdekoodin‰kym‰‰n. </li>
  <li> Ensimm‰isen k‰‰nnˆsvaiheen valmistuminen: onnistuneen ensimm‰isen kierroksen j‰lkeen <a href="Compile.html">objektikoodin‰kym‰</a> tuodaan esiin ja toinen kierros voi alkaa. </li> 
  </ul>
  <p> Toinen kierros: </p>
  <ul> 
  <li> Objektikoodin luonti: koodiriville tuodaan k‰skyn konekieliesitys ja k‰sky n‰ytet‰‰n alapalkin tilatiedoissa. </li>
  </ul>
  <p> K‰‰nnˆksen valmistuminen: </p>
  <ul>
//   	<li>Ohjelma <a href="#loading">ladataan</a> muistiin ja <a href="Suoritusnakyma.html">suoritusn‰kym‰</a> tuodaan esille.</li>
  	<li> K‰‰nnˆksen virhetilanne: k‰‰nnˆs keskeytet‰‰n, virheest‰ ilmoitetaan k‰ytt‰j‰lle ja jatka-painikkeella palaudutaan l‰hdekoodin‰kym‰‰n. </li>
	<li>Bin‰‰ritiedosto <a href="#binaari">tallennetaan</a> automaattisesti samaan hakemistoon samalla nimell‰ muuten mutta eri p‰‰tteell‰; p‰‰te on b91.</li>
  </ol>
  </ul>
  <br>
  
  
  
  <!-- KƒƒNN÷SASETUKSET-->
  
  
  
  <table cellspacing=10>
  <tr>
  <td>  
  <img src="img/0.jpg" title="" 
  alt="">
  </td>
  <td>
  <a name="compilesettings">
  <h3>3.4 K‰‰nnˆsasetukset </h3>
  </a>
  </td>
  </tr>
  </table>
  
  
  
  
  <table cellspacing=10>
  <tr>
  <td>
  <img src="img/Tiedostomuokkaakaannos.jpg" title="K‰‰nnˆsasetukset valikosta" 
  alt="K‰‰nnˆsasetukset valikosta">
  </td>
  <td valign=top>
  <p>
  K‰‰nnˆksen aikaisia asetuksia voi muuttaa valitsemalla valikosta Asetukset --> Muokkaa k‰‰nnˆsasetuksia.
  </p>
  </td>
  
  </tr>
  <tr>
  <td>
  
  <img src="img/Kaannosasetukset.jpg" title="K‰‰nnˆsasetukset" 
  alt="K‰‰nnˆsasetukset">
  
  </td>
  <td valign=top> 
  <p>
  K‰‰nnˆsasetuksilla voidaan vaikuttaa k‰‰nnˆksen etenemistapaan ja kommentointiin.
  </p>
  <ul>
  <li>Jos 'Pys‰yt‰ k‰‰nt‰minen kommentin ilmestyess‰' on valittuna, k‰‰nnˆs etenee askelittain. K‰‰nnˆs j‰‰ odottamaan k‰ytt‰j‰lt‰ seuraavaa <a
  href=#kaantajantoiminnot>toimintoa</a>.
  </li>
  <li>Jos 'N‰yt‰ lis‰kommentteja k‰‰nt‰misen kulusta' on valittuna, rivin k‰‰nt‰misest‰ ilmestyy lis‰kommentteja kommentti-ikkunaan.
  </li>
  <li> Asetusten muutokset tulevat voimaan painamalla 'aseta'-painiketta.</li>  
  </ul>
    
  </td>
  
  </tr>
  </table>
  
  <br>
   
  
  
  
  
  <!-- OHJELMAN LATAAMINEN-->
  
  
  
  
  <table cellspacing=10>
  <tr>
  <td>  
  <img src="img/0.jpg" title="" 
  alt="">
  </td>
  <td>
  <h3><a name="loading">3.5 TTK-91-ohjelman lataaminen</a></h3>
  </td>
  </tr>
  </table>
  
  
  <p> Ohjelman lataaminen tapahtuu automaattisesti </p>
  <ul>
  <li>K91-tiedoston <a href="#compile">k‰‰nnˆksen</a> valmistuessa.</li>
  <li>B91-tiedoston <a href="#open">avaamisen</a> yhteydess‰ </li>
  <li>Ohjelman suorituksen j‰lkeen; jos itse‰‰n muuttavaa ohjelmaa on suoritettu, koodialueen muutokset poistetaan.</li>
  </ul>
  <br>
  
  
   <!-- SUORITUS-->
  
  
    
  <table cellspacing=10>
  <tr>
  
  <td>  
  <a name="run">
  <img src="img/3.jpg" title="Run" 
  alt="Picture of run-button">
  </td>
  </a>    
  
  <td>
  <h3> 3.6 TTK-91-ohjelman suoritus</h3> <!-- Ja uudelleensuoritus -->
  </td>
  
  </tr>
  </table>
     
  
  <table cellspacing=10>
  <tr>
  <td>  
  <img src="img/Filerun.jpg" title="File run" 
  alt="Running from menu">
  </td>
  <td valign=top> K91-tiedoston k‰‰nnˆksen tai b91-tiedoston avaamisen seurauksena ohjelma ladataan muistiin ja on valmis suoritettavaksi.<a href="Running.html">
  Suoritusn‰kym‰ss‰</a> koodi-ikkuna on jaettu kahteen osaan, koodi- ja data-alueeseen. On kuitenkin syyt‰ huomioida, ett‰ Titokoneen muisti on todellisuudessa yhten‰inen alue; muistialueen jako kahteen osaan on toteutettu k‰ytett‰vyyssyist‰. Suoritus aloitetaan painamalla  <a href="3en.html">suorita-pikakuvaketta</a>  tai valitsemalla valikosta Tiedosto --> Aja. Suoritus toteutetaan <a href="#runsettings">suoritusasetusten</a> mukaisesti joko pys‰hdellen tai kerralla loppuun asti suorittaen. </td>
  
  </tr>
  </table>
  <br>
  
  <b> Toiminnot suorituksen aikana </b>
  
  <table cellspacing=10>
  <tr>
   
  <td>
  <img src="img/4.jpg" title="Forward" 
  alt="Picture of forward-button">
  </td>
  <td><p> Jatka askelittain: ohjelman ajaminen voidaan tehd‰ rivi kerrallaan.</p>
  </td>
  </tr>
  
  <tr>
  <td><img src="img/5.jpg" title="FF" 
  alt="Picture of FF-button">
  </td>
  
  <td><p> Jatka: halutessaan k‰ytt‰j‰ voi suorittaa ohjelman loppuun pys‰htelem‰tt‰.</p>
  </td>
  </tr>
  
  <tr>
  <td><img src="img/6.jpg" title="STOP" 
  alt="Picture of stop-button">
  </td>
  <td>
  <p> Pys‰yt‰: suoritus voidaan pys‰ytt‰‰ painamalla pys‰yt‰-nappia.</p>
  </td>
  </tr>
  </table>
  <ul><li> Jos suoritus keskeytyy virheeseen, lopputilanne
n‰ytet‰‰n viel‰. K‰ytt‰j‰ voi t‰llˆin painaa jatka-nappia ladatakseen
ohjelman uudelleen.</li></ul>
  <br>
  
  
  
  
  
  <!-- SUORITUSASETUSTEN MUUTTAMINEN -->
  
  
  
  
  <table cellspacing=10>
  <tr>
  
  <td>  
  <a name="runsettings">
  <img src="img/0.jpg" title="" 
  alt="">
  </a>
  </td>
  <td>
  <h3>3.7 Suoritusasetukset </h3>
  </td>
  </tr>
  </table>
  
  
  <table cellspacing=10>
  <tr>
  <td>
  <img src="img/Runningdialog.jpg" title="Set running options" 
  alt="Setting running options from menu">
  </td>
  <td valign=top>
  <p> Suoritusasetuksia p‰‰see vaihtamaan valitsemalla valikosta Asetukset --> Muuta suoritusasetuksia. </p>
  
  </td>
  </tr>
  <tr>  
  <td rowspan=3>
  <img src="img/Runningoptions.jpg" title="Running options" 
  alt="Running options">
  </td>
  <td>
  <p> Suoritusasetukset ovat melko pitk‰lti vastaavat <a href="#compilesettings">k‰‰nnˆsasetusten</a> kanssa; lis‰toimintona on animointi.
  <ul>
  <li> Ohjelmakoodia voidaan suorittaa rivi kerrallaan </li>
  <li> Lis‰kommentteja voidaan n‰ytt‰‰ <a href="Running.html">kommentti-ikkunassa(8)</a></li>
  <li> Animointi-ikkuna n‰ytt‰minen voidaan kytke‰ p‰‰lle tai pois </li>
  <li> Kun animointi on p‰‰ll‰, riveitt‰in suoritus menee automaattisesti p‰‰lle. </li>
  <li> Asetusten muutokset tulevat voimaan painamalla 'aseta'-painiketta.</li>  
  </ul>
  </td>
  </tr>
  </table>
  
  <p> Suoritusasetuksia on mahdollista muuttaa myˆs suoraan pikakuvakkeista:</p>
  <table cellspacing=10>
  <tr>
  <td>
  <img src="img/7.jpg" title="Line-by-line on / off" 
  alt="Executing line-by-line on / off">
  </td>
  <td>
  <p>   Riveitt‰in suorituksen kytkeminen p‰‰lle tai pois. </p>
  </td> 
  </tr>
  <tr>
  <td>
  <img src="img/8.jpg" title="Extra comments on / off" 
  alt="Extra comments on / off">
  </td>
  <td>
  <p> Suorituksen lis‰kommentoinnin kytkeminen p‰‰lle tai pois. </p>
  </td>
  
  </tr>
  <tr>
  <td>
  <img src="img/9.jpg" title="Animating" 
  alt="Animating on / off">
  </td>
  <td>
  <p> Animointi-ikkunan n‰ytt‰misen kytkeminen p‰‰lle tai pois. </p>
  </td>
  </tr>
  </table>
  <br>
  
  
  
  
  <!-- Animointi -->
    
  
  
  <table cellspacing=10>
  <tr>
  
  <td>  
  <img src="img/0.jpg" title="" 
  alt="">
  </td>
  <td>
  <h3>3.8 Animointi</h3> 
  </td>
  </tr>
  </table>
  
  
  <table>
  <tr>
  <td>
  <img src="img/Animate.jpg" title="Animator" 
  alt="Picture of Animator">
  </td>
  </tr>
  </table>
  <br>
  
  
  
  <!-- STDIN, STDOUT -->
  
    
  
  
  
  <table>     
  <tr>
  <td>  
  <img src="img/0.jpg" title="" 
  alt="">
  </td>
  <td> 
  <h3>3.9 STDIN- ja STDOUT-tiedostojen valinta </h3>
  </td>
  </tr>
  </table>
  
  
  <table>     
  <tr>
  <td>  
  <img src="img/Setstd.jpg" title="STDIN & STDOUT" 
  alt="Choosing STDIN- and STDOUT-files">
  </td>
  <td> 
  
  </td>
  </tr>
  </table>
  <br>
  
  
  
  
  <!-- MUISTIN TYHJENTƒMINEN -->
  
  
  
  
  
  <table cellspacing=10>
  <tr>
  <td>  
  <img src="img/0.jpg" title="" 
  alt="">
  </td>
  <td>
  <h3> 3.10 Muistin tyhjent‰minen</h3> 
  </td>
  </tr>
  </table>
   
  <!-- Viimeist‰‰n t‰‰ll‰ maininta muistin pysymisest‰ samana ellei sit‰
       nollata. -->
  <table>
  <tr>
  
  <td>
  <img src="img/Erasememory.jpg" title="Erase memory" 
  alt="Erasing the memory -menu">
  </td>
  <td valign=top>
  <p> Titokoneen muistin voi tyhjent‰‰ valikosta valitsemalla <b>Tiedosto --> Tyhjenn‰ muisti</b>. Muistin tyhjent‰misen lis‰ksi toiminnolla voidaan tyhjent‰‰ l‰hdekoodin‰kym‰. 
  Jos toimintoa k‰ytet‰‰n k‰‰nnˆs- tai ajovaiheessa, kyseinen toiminto keskeytyy ja ruudulle palautetaan <a href="Openview.html">avausn‰kym‰</a>, jossa rekisterit, symbolitaulu ja
  koodin‰kym‰ on tyhjennetty. </p> 
  
  </td>
  
  </tr>
  </table>
  <br>
  
  <table>     
  <tr>
  <td>  
  <img src="img/0.jpg" title="" 
  alt="">
  </td>
  <td> 
  <h3>3.11 Muistin koon vaihtaminen</h3>
  </td>
  </tr>
  </table>
   
  
  <table>
  <tr>
  <td>
  <img src="img/Memory.jpg" title="Change memory size" 
  alt="Change memory size -menu">
  </td>
  <td valign=top>
  <p> Titokoneen muistin kokoa on mahdollista muuttaa valitsemalla valikosta <b>Asetukset --> Aseta muistin koko</b>.
  Muistin kokovaihtoehtoja on kahdeksan erilaista 512 rivist‰ 65536 riviin asti. Kun uusi muistin koko asetetaan, koodin‰kym‰ tyhjennet‰‰n
  ja n‰kyville palautetaan <a href="Avausnakyma.html">avausn‰kym‰</a>.</p>
  </p>
  <p>Kun muistin koko ylitt‰‰ 32768 rivi‰, loppup‰‰n riveihin ei voida viitata suoraan koodista, sill‰ vakio-osaan ei mahdu 32768:aa suurempia lukuja. Sen sijaan esimerkiksi riville
  32768+500 voidaan viitata seuraavalla koodinp‰tk‰ll‰:</p>
<pre>
   LOAD R1, =32768 ; Ladataan maksimivakio rekisteriin
   LOAD R2, 500(R1) ; Ladataan rivin 32768+500 sis‰ltˆ R2:een.
</pre> </td></tr>
  </table>
  <br>
  
  
  
  <!-- KIELEN VAIHTAMINEN -->
  
  
  
  
  
  <table>
  <tr>
  <td>  
  <a name="changelanguage">
  <img src="img/0.jpg" title="" 
  alt="">
  </a>
  </td>
  <td>
  <h3>3.12 K‰yttˆliittym‰n kielen vaihtaminen</h3>
  </td>
  </tr>
  </table>
  
  <table>
  <tr>
  
  <td>
  <img src="img/Setlanguage.jpg" title="Setting the language" 
  alt="Language settings -menu">
  </td>
  <td valign="top">
  <p>Titokoneen k‰yttˆliittym‰ss‰ on mahdollista vaihtaa kieliasetuksia. Kieli valitaan valikosta <b>Asetukset --> Aseta kieli</b>. Oletuskielin‰ ovat suomi ja englanti. Kielen voi vaihtaa suoraan lennosta, l‰hes riippumatta k‰yttˆliittym‰n muista toiminnoista. Jos k‰ytt‰j‰ on m‰‰ritellyt oman kielitiedoston, h‰n voi joko valita sen luettelosta lis‰tty‰‰n sen kieliasetustiedostoon tai valita sen erillisest‰ tiedostosta. Kieliasetustiedostoon lis‰tyt kielet tulevat n‰kyville 'Aseta kieli' -valikon alle. Erillisess‰ tiedostossa
  olevan kielitiedoston avaaminen onnistuu valikon kohdasta 'Valitse tiedostosta...'. Jos kielitiedosto on oikeaa muotoa, kieli vaihtuu v‰littˆm‰sti. Jos tietyn tekstin k‰‰nnˆsvastine puuttuu kielitiedostosta, k‰ytet‰‰n k‰yttˆliittym‰ss‰ oletuskielt‰, englantia, kyseisen tekstin kohdalla. Lis‰ohjeita uuden kielen lis‰‰miseen lˆytyy kohdasta <a href="#addlanguage">Uuden kielen tukeminen</a>. 
 
  </p>
  </td>
  </tr>
  </table>
  <br>

 <!-- Jne, sopivassa j‰rjestyksess‰. -->

<h2><a name="machinelanguage">4. TTK-91-konekieli</a></h2>
<!-- T‰ss‰ voi mietti‰, haluaako toistaa tekstitiedoston speksin v‰h‰n 
     siistimm‰ss‰ formaatissa vaiko vain. Mietin, nyt p‰‰dyin t‰h‰n...
-->
<br>
<h3>

                    4.1  A SUMMARY OF TTK-91 COMMANDS
</h3>
<br>

<pre>
+--------------------------------------------------------------------+
|  Operation code  ¶  Rj ¶ M ¶  Ri ¶      address part ADDR          |
|  8 bits          ¶  3  ¶ 2 ¶  3  ¶         16 bits                 |
+--------------------------------------------------------------------+
31               24 23           16 15                               0
</pre>

<p>
In the symbolic machine language, the commands are of the form
</p>

<pre>LABEL OPER Rj,M ADDR(Ri)

where  OPER    the symbolic name of the command
       Rj      the first operand (register R0..R7)
       M       addressing mode:
               =   immediate operand
                   direct addressing (empty, ie. not marked)
               @   indirect addressing
       ADDR    address part (memory address or constant value)
       Ri      possible index register (register R0..R7)        
</pre>
<p>
If some part of a command has no meaning, it can be left out. It is 
possible to add a label (symbolic address) in front of a command. The 
label should consist of the letters A-÷, 0-9 and _, and contain at 
least one non-numerical character. Only the first 8 characters are
considered.
</p>
<p>
Almost all commands have the following forms available:
</p>
<pre>
   OPER Rj,ADDR        direct memory addressing
   OPER Rj,=ADDR       immediate operand
   OPER Rj,@ADDR       indirect memory addressing
   OPER Rj,ADDR(Ri)    indexed addressing
   OPER Rj,=ADDR(Ri)   indexed immediate operand
   OPER Rj,@ADDR(Ri)   indexed indirect memory addressing      
   OPER Rj,Ri          direct register addressing
</pre>
<p>
There are exceptions:
</p>
<pre>
    STORE           The latter operand is always the target address;
                    it cannot be a register or a constant value.
    POP             The latter operand must always be a register.   
    JUMP COMMANDS   The latter operand is always the target address;
                    it cannot be a constant. In the jump commands which
                    look at the state register, the first operand is  
                    ignored.               
    NOP             The operands are ignored.  
</pre>
    

<br>
<h3>
		4.2 The symbolic commands of the TTK-91 machine language
</h3>

<p>
Data transfer commands:
</p>

<pre>
LOAD   Stores the value of the latter operand to the register Rj.
STORE  Stores the integer in Rj as the value of the latter operand.    
IN     Reads an integer from the device given as the latter operand 
       into the register Rj (eg. IN R1,=KBD to read from the keyboard).
OUT    Outputs the integer in the register Rj to the device given as 
       the latter operand (eg. OUT R1,=CRT to print to screen).
</pre>
<p>
Arithmetic and logical commands:
</p>

<pre>
The result of the calculation is stored in register Rj.

ADD    Adds the value of the latter operand to the integer in the
       register Rj.
SUB    Substracts the value of the latter operand from the integer in 
       the register Rj.
MUL    Multiplies the integer in the register Rj with the value of the
       latter operand.
DIV    Divides the integer in the register Rj with the value of the 
       latter operand, and stores the whole part in Rj.
MOD    Modulo divides the integer in the register Rj with the value of
       the latter operand, and stores the remainder in Rj.
AND    Boolean logic 'and' between Rj and the value of the latter operand.
OR     Boolean logic 'or' between Rj and the value of the latter operand.
XOR    Boolean logic 'exclusive or' between Rj and the value of the
       latter operand.
SHL    Shifts the bits of the register Rj left, with the number of
       shifts given by the value of the latter operand. Fills the
       right end with 0 bits.
SHR    Shifts the bits on the register Rj right, otherwise like SHL.
SHRA   Performs an arithmetic right shift; as in SHR, but fills the
       left end with copies of the leftmost bit, thus keeping negative
       numbers negative.

COMP   Compares the first operand with the second operand and stores
       the result in the status register SR's bits L=less, E=equal,
       G=greater. See eg. JLES.
</pre>
<p>
Forking commands:
</p>

<pre>
JUMP   An unconditional jump to the target address expressed by the
       second operand.

JNEG   Jump if negative. If Rj &lt; 0, jumps to the address given as the
       second operand, otherwise continues with the next command.
JZER   Jump if zero,      ie. if Rj = 0
JPOS   Jump if positive,      if Rj &gt; 0
JNNEG  Jump if not negative,  if Rj &gt;= 0
JNZER  Jump if not zero,      if Rj &lt;&gt; 0
JNPOS  Jump if not positive,  if Rj &lt;= 0

JLES   Jump if less - if the status register SR has its L bit set,
       jumps to the address given as the second operand, otherwise
       continues from the next command. Used together with the COMP 
       command.
JEQU   Jump if equal,      ie. if E bit is set in SR
JGRE   Jump if greater,        if G bit is set in SR
JNLES  Jump if not less,       if E or G bit is set in SR
JNEQU  Jump if not equal       if L or G bit is set in SR 
JNGRE  Jump if not greater     if L or E bit is set in SR
</pre>

<p>
Stack commands:
</p>

<p>
The first operand of the command, the register Rj, points to the top
of the stack, ie. the topmost item in it. Usually, the register SP
(which is also R6) is used as the stack pointer.
</p>

<pre>
PUSH   Increases the stack pointer Rj's value by one and stores the latter
       operand as the topmost item in the stack.

POP    Removes the topmost item in the stack and stores it as the  
       register Ri (the latter operand is always a register). Substracts
       one from the stack pointer Rj.           

PUSHR  Pushes the registers R0, R1, R2, R3, R4, R5 and R6 (SP) to the 
       stack, in this order. Before pushing each register, increases the
       stack pointer Rj's value by one.

POPR   Pops values to the registers R6 (SP), R5, R4, R3, R2, R1 and
       R0, in this order, from the stack. For each pop, first fetches
       the value from the top of the stack indicated by the register  
       Rj, and then substracts one from Rj.
</pre>

<p>
Subroutine commands:
</p>

<pre>
CALL   Call procedure. Moves the control (by manipulating the program 
       counter) to the address given by the latter operand. Stores the
       return address to the stack, with its top indicated by Rj.
EXIT   Returns from a procedure to the command following its call. The
       return address is found from the stack, the top of which Rj
       points to. The latter operand indicates the number of parameters
       passed to the subroutine in the call.
</pre>
      
<p> 
System calls:  
</p>

<pre>
SVC    Supervisor call. Calls a service routine in the operating system.
       The first operand is Rj, indicating the top of the stack, the 
       latter operand gives the number identifying the service.
       Supervisor calls are special subroutine calls to predefined 
       procedures. Their code is invisible to the user, and is considered
       to be stored "outside" the memory space.

       Service identifiers:

       HALT : Stops the execution of the program.
       TIME : Gives the time of day. The stack should contain the 
              addresses to store the hour, minute and second values.
              Note their order!
       DATE : Gives the date. The stack should contain the addresses 
              to store the year, month and day values. Note their order!
       READ : Reads an integer from the keyboard. The stack should 
              contain the address to store the integer to.
       WRITE: Prints an integer to the screen. The stack should
              contain the value to print.
</pre>

<p>
Other:
</p>

<pre>
NOP    No operation. This command does nothing.
</pre>
<br>
<h3>
		4.3 The operation codes of the TTK-91 commands
</h3>

<pre>
   Command   Binary     Decimal  Hexadecimal   

   NOP       0000 0000     0        00            

   STORE     0000 0001     1        01
   LOAD      0000 0010     2        02
   IN        0000 0011     3        03
   OUT       0000 0100     4        04

   ADD       0001 0001    17        11
   SUB       0001 0010    18        12
   MUL       0001 0011    19        13
   DIV       0001 0100    20        14
   MOD       0001 0101    21        15

   AND       0001 0110    22        16
   OR        0001 0111    23        17
   XOR       0001 1000    24        18
   SHL       0001 1001    25        19
   SHR       0001 1010    26        1A
   SHRA      0001 1011    27        1B

   COMP      0001 1111    31        1F

   JUMP      0010 0000    32        20
   JNEG      0010 0001    33        21
   JZER      0010 0010    34        22
   JPOS      0010 0011    35        23
   JNNEG     0010 0100    36        24
   JNZER     0010 0101    37        25
   JNPOS     0010 0110    38        26

   JLES      0010 0111    39        27
   JEQU      0010 1000    40        28
   JGRE      0010 1001    41        29
   JNLES     0010 1010    42        2A
   JNEQU     0010 1011    43        2B
   JNGRE     0010 1100    44        2C

   CALL      0011 0001    49        31
   EXIT      0011 0010    50        32
   PUSH      0011 0011    51        33
   POP       0011 0100    52        34
   PUSHR     0011 0101    53        35
   POPR      0011 0110    54        36

   SVC       0111 0000   112        70
</pre>
<br>
<h3>
		4.4 Predefined symbols of the TTK-91 machine   
</h3>
		
<p>
These symbols can be used without explicitly defining them in a 
TTK-91 program.
</p>

<pre>
Symbol          Value
---------------------
CRT             0
KBD             1
STDIN           6
STDOUT          7
HALT            11
READ            12
WRITE           13
TIME            14
DATE            15
</pre>

<br>
<h3>
		4.5 Instructions to the compiler (fake commands)
</h3>

<p>
The compiler instructions direct the program translating the symbolic
machine language to binary. They are NOT actual symbolic commands.
</p>
<pre>
name EQU value
</pre>
<p>
The alias command EQU defines a symbolic name for an integer
value. The symbol name can be used in the ADDR field of a command, in
which case it will be handled as 'value' written in its stead
would be.
</p>
<pre>
name DC value
</pre>
<p>
The memory allocation command DC (data constant) allocates one word of
memory for a constant, aliases 'name' with the constant's memory
address and stores 'value' in the allocated address in the
memory. 'Name' can then be used in a command's ADDR field as a
memory address.
</p>

<pre>
name DS size
</pre>
<p>
The memory allocation command DS (data segment) allocates an area of
memory, sized 'size' words. It aliases 'name' with the start address
of the memory area. 'Name' can then be used in a command's ADDR field
as a memory address. This instruction is used for allocating space for
global variables.
</p>

<pre>
option DEF string
</pre>
<p>
This special instruction changes options for simulating the file
system of a TTK-91 machine. 'String' should be an absolute directory 
path.
</p>

<p>
Examples: 
</p>
<pre>
  STDIN DEF /home/myuser/ttk91/stdin
  STDOUT DEF C:\mydir\stdout
</pre>
<p>
Available options are:
</p>

<pre>
  STDIN   To set which file stdin data is read from.
  STODUT  To set which file stdout data is written to.
  HOME    To set the user's home directory for this application;
          unused in Titokone as the home directory is requested from
          the underlying operating system via the Java virtual machine.
</pre>

<p>
The default files for the two first options are stdin and stdout in
the user's current working directory.
</p>
<p>
Jos yhteenveto Titokoneen k‰skykannasta ei tyydytt‰nyt tiedonjanoasi, lis‰‰ aiheesta lˆyd‰t kurssin <a href="http://www.cs.helsinki.fi/u/kerola/tito/">Tietokoneen toiminta</a> kotisivuilta.
</p>
<br>

<h2><a name="extension">5. J‰rjestelm‰n hienos‰‰tˆ ja laajentaminen</a></h2>

  <h3>5.1 Asetustiedostot</h3>

<p>
Kun k‰ytt‰j‰ muuttaa asetuksia, Titokone tallentaa muutokset t‰m‰n
kotihakemistoon tiedostoon titokone.cfg. Asetustiedosto ylikirjoittuu
joka asetusmuutoksen j‰lkeen. 
</p>
<p>
Mik‰li Titokone on avattu jar-paketistaan, j‰rjestelm‰n oletusasetukset
lˆytyv‰t tiedostosta fi/hu/cs/titokone/etc/settings.cfg. T‰m‰n tiedoston
sis‰ltˆ on seuraavanlainen:
</p>
<pre>
   # Default settings. Running mode: commented (+1), one row at a time (+2),
   # but not animated (+4) compilation mode: commented (+1) but not
   # one happening at a time (+2). Stdin and stdout file paths given are
   # relative to the current working directory. 'Stdout use' describes that
   # the file should be used in append mode ('append') instead of
   # overwriting ('overwrite') it for every new run. Memory size is 2^9 =
   # 512 lines.
   Language = English
   Running mode = 3
   Compilation mode = 1
   Stdin file = stdin
   Stdin path = relative
   Stdout file = stdout
   Stdout path = relative
   Stdout use = append
   Memory size = 9
</pre>
<p>
Asetustiedoston k‰sin muuttamiseen ei yleens‰ ole tarvetta. STDIN- ja
STDOUT-tiedostojen polut tallentuvat tiedostoon kuitenkin aina ns.
absoluuttisessa muodossa, kun ne on valittu Titokoneen
k‰yttˆliittym‰st‰. Mik‰li polku halutaan ilmaista suhteessa
tyˆhakemistoon, n‰in voidaan tehd‰ asettamalla kohdan "Stdin path" tai
"Stdout path" arvoksi 'relative', kuten yll‰.
</p>
<p>
Lis‰ksi, samoin jar-paketin sis‰ll‰ fi/hu/cs/titokone/etc/-hakemistossa,
sijaitsee kieliasetustiedosto languages.cfg. T‰st‰ tiedostosta Titokone
hakee luettelon j‰rjestelm‰n osiksi lis‰tyist‰ kielitiedostoista, jotka
luetellaan kielenvaihtovalikossa kielen nimen perusteella. T‰llaiset
kielitiedostot on sijoitettu fi/hu/cs/titokone/resources/-hakemistoon, 
niiden nimi on muotoa Translations_xx.class ja ne kuuluvat pakettiin
fi.hu.cs.titokone.resources. Kielitiedosto muodostuu pareista muotoa
"kielen nimi valikossa" = "xx". Arvon "xx" tulee olla kielt‰ kuvaava
kaksikirjaiminen tunnus (t‰m‰ syˆtet‰‰n java.util.Localen
konstruktorille). Oletuskielitiedoston sis‰ltˆ on seuraavanlainen:
</p>
<pre>
   Suomi = fi
   English = en
</pre>

 
  
  
  
  <h3><a name="addlanguage">5.2 Uuden kielen tukeminen</a></h3>
<p> Uuden kielen lis‰‰minen Titokoneeseen tapahtuu antamalla k‰‰nnˆsvastineet oletuskielen‰ toimivan kielen sanoille. Oletuskielen‰
on englanti. Lis‰tt‰v‰‰ kielt‰ varten kirjoitetaan ohjeiden mukainen Java-tiedosto, joka k‰‰nnet‰‰n ja avataan Titokoneen k‰yttˆliittym‰n kautta. Uuden kielitiedoston kirjoittaminen k‰y helpoiten ottamalla mallia olemassaolevasta kielitiedostosta. Avaa koneeltasi ensin tekstieditori, johon haet Titokone.jar -paketin mukana tulleen tiedoston Translations_fi.java -tiedoston hakemistosta fi/hu/cs/titokone/resources. Tekstieditoriin aukeaa Javan ResourceBundle-kalustoa
hyv‰ksik‰ytt‰v‰ luokka, joka muodostuu 2-ulotteisesta Object-taulukosta ja sen palauttavasta metodista. Taulukon alkiot n‰ytt‰v‰t seuraavilta:</p>
<pre>
   { "Fetch second operand from memory slot {0}.", "Nouda j‰lkimm‰inen operandi muistipaikasta {0}."},
   { "Indirect memory addressing mode.", "Ep‰suora muistiosoitus."},
   { "1: Fetch indexing value from memory slot {0}.", "1: Nouda indeksointiarvo muistipaikasta {0}."}, 
</pre>
<p> 
Jokainen rivi koostuu aaltosulkujen v‰liss‰ olevasta oletuskielen avainarvosta ja sen k‰‰nnˆsvastineesta. 
Uloimpien aaltosulkujen sis‰ll‰ on kaksi lainausmerkeill‰ rajattua tekstikentt‰‰, jotka on erotettu pilkulla toisistaan. Ensimm‰isten lainausmerkkien sis‰ll‰ on oletuskielinen k‰‰nnˆsavain. Toisten lainausmerkkien sis‰ll‰ on k‰‰nnˆsvastine. Oma k‰‰nnˆsvastine luodaan korvaamalla suomenkielinen teksti. Yleens‰
lauseen merkitys on jossain m‰‰rin p‰‰telt‰viss‰ itse lauseesta. K‰‰nnˆksi‰ helpottamaan Translations_fi -tiedostossa on kommenteilla kerrottu, mihin luokkaan kyseiset k‰‰nnˆkset viittaavat. Jos k‰‰nnett‰v‰n lauseen merkitys tuntuu ep‰selv‰lt‰, luokan l‰hdekoodista on mahdollista selvitt‰‰ k‰‰nnˆkseen sijoitettavan muuttujan tarkoitus. 
</p>
<p>
Allaolevan esimerkin k‰‰nnˆksiss‰ esiintyy erikoismerkkijono, '{0}'. Kyseisen merkkijonon tilalle sijoitetaan muuttuja, joka liittyy k‰yttˆliittym‰lle v‰litett‰v‰‰n viestiin. Esimerkin ensimm‰isen rivin {0} sis‰lt‰‰ muistipaikan numeron. K‰‰nnˆst‰ tehdess‰ on mahdollista luoda uusi k‰‰nnˆsvastine, jonka muuttuja
ei olekaan rivin lopussa, esimerkiksi:
<pre>
//Animator
{ "Fetch second operand from memory slot {0}.", "Nouda j‰lkimm‰inen operandi muistipaikasta {0}."},
-->
//Animator
{ "Fetch second operand from memory slot {0}.", "Muistipaikasta {0} noudetaan j‰lkimm‰inen operandi."},
</pre>
<p> Uusi kielitiedosto luodaan seuraavasti: </p>
<ol>
<li> Avaa Translations_fi.java.</li>
<li> Tallenna tiedosto haluamaasi paikkaan haluamallasi nimell‰, mutta .java-p‰‰tteisen‰. </li>
<li> Anna k‰‰nnˆsvastineet suomenkielisten tekstien kohdalle. </li>
<li> Sijoita muuttujat {0}...{n} mielekk‰ille paikoille lauseessa </li>
<li> Poista tiedostosta rivi 4: 'package fi.hu.cs.titokone.resources;'.</li>
<li> Vaihda luokan nimi vastaamaan antamaasi tiedoston nime‰.</li>
<li> K‰‰nn‰ tiedosto esimerkiksi javac-komennolla</li>
<li> K‰ynnist‰ Titokone </li>
<li><a href="#changelanguage">Vaihda kielitiedosto</a> </li>
</ol>
<p>
Voit myˆs lis‰t‰ uuden kielen pysyv‰ksi osaksi j‰rjestelm‰‰, jolloin
k‰‰nnˆstiedostoa ei en‰‰ tarvitse etsi‰ joka kerta uudelleen. Tallenna
kohdassa 2 tiedosto hakemistoon fi/hu/cs/titokone/resources/ muiden
k‰‰nnˆstiedostojen kanssa. Muuta luokan nimeksi rivill‰ 
</p>
<pre>
public class Translations_fi {
</pre>
<p>k‰‰nnˆskielesi ('xx') mukaan Translations_xx ja tallenna se tiedostoon Translations_xx.java. Korvaa
'xx' kohdekielesi ISO-koodilla (Javan Localen tukemat versiot ISO 639:st‰). Esimerkiksi jos k‰‰nt‰isit ohjelman norjaksi, koodi olisi 'no', saksan vastaava olisi 'de'. <b>ƒl‰ poista tiedostosta (kohdan 4
mukaan) pakettim‰‰rerivi‰</b>, sill‰ nyt sit‰ tarvitaan. 
</p>
<p>
Kun k‰‰nnˆksesi on valmis ja sille on k‰‰nnetty .class-tiedosto, asenna
se lis‰‰m‰ll‰ kieliasetustiedostoon fi/hu/cs/titokone/etc/languages.cfg
rivi "kielen nimi valikossa" = "xx", jossa korvaat taas xx:n
kielikoodillasi. Esimerkiksi "Deutsch = de". Ks. myˆs asetustiedostot.
Kun nyt k‰ynnist‰t Titokoneen seuraavan kerran, uusi kieli on yhten‰
vaihtoehtona valikossa.
</p>

<br>

<h2><a name="troubleshooting">6. Virhetilanteita</a></h2>

  <ol>
  <li><a href="#thread">Komentorivi-ikkunaan tuleee eriskummallisia virheilmoituksia</a></li>
  <li><a href="#stdinerror">STDIN-tiedoston lukemisessa tapahtui virhe</a></li>
  <li><a href="#comptwo">K‰‰nt‰j‰ ei korosta virheellist‰ rivi‰</a></li>
  <li><a href="#selfcode"> Itse‰‰n muuttava koodi ei toimi </a></li>
  <li><a href="#chosen"> K‰‰nnˆs jumittuu ensimm‰isell‰ kierroksella </a></li>
  <li><a href="#paranoid"> L‰hdekooditiedosto kirjoittui yli?</a></li>
  <li><a href="#variable"> Ep‰kelpo luku muuttujassa?</a></li>
  <li><a href="#animazion"> Ep‰kelpo luku muuttujassa?</a></li>
  <li><a href="#spfp"> Animaattorin SP ja FP, miss‰ ne ovat?</a></li>
  <li><a href="#R0"> Rekisterist‰ R0 tulee pelkk‰‰ nollaa </a></li>
  <li><a href="#help"> Ei n‰ist‰ mit‰‰n apua lˆytynyt...</a></li>
  </ol>

  <br>
  <a name="thread"><b>Kysymys: N‰en ikkunassa, josta k‰ynnistin Titokoneen, outoja Javan
   virheilmoituksia. Sovellus ei kuitenkaan vaikuta kaatuneen. Mist‰ on kyse? -Arto ≈.</b></a>
   <div>
   Vastaus: Ongelmat johtuvat p‰‰asiassa kuun v‰‰r‰st‰ asennosta. Er‰‰n‰ osasyyn‰ saattavat olla samanaikaisuusongelmat, joilta olisimme voineet kenties v‰ltty‰ jos
   olisimme muistaneet Rinnakkaisohjelmistot-kurssin asiat jo aiemmin; osan
   taas aiheuttavat Javan grafiikkakirjasto Swingin viat, joita emme p‰‰se
   korjaamaan. Pahoittelumme.</div>

  <br>
  <a name="stdinerror"><b>Kysymys: Mik‰ kysymys liittyy t‰h‰n vastaukseen? Nimim.S.R.</b></a>
  <div>
  Vastaus: Ohjelma ilmoittaa vain, ett‰ mik‰li tulevaisuudessa n‰ill‰ asetuksilla joku 
  TTK-91-sovellus yritt‰‰ lukea STDIN-laitteelta, luku ep‰onnistuu ellei jotain tehd‰
  asialle. "Joku syy" -osuus kertoo, mik‰ j‰rjestelm‰n antama
  virheilmoitus oli kun tiedostoa luettiin. Jos sovelluksesi tarvitsee
  STDIN-laitetta, korjaa tiedoston tilanne ja lataa sovellus
  uudelleen. Katso myˆs <a href="#loading">2.5, TTK-91-ohjelman
  lataaminen</a>.</div>
  
  <br>  
   <a name="comptwo"><b>Kysymys: Ohjelmaani oli j‰‰nyt virheellinen rivi
  koodia; yritin k‰ytt‰‰ m‰‰rittelem‰tˆnt‰ muuttujaa. Virheilmoitus tuli kyll‰ ruudulle,
  mutta rivi ei korostu. Mit‰ ihmett‰? Terveisin, revenneet pelihousut.</b></a>
  
  <div>Vastaus: k‰‰nnˆksen toisessa vaiheessa, objektikoodin luonnissa olevaa virheellist‰ rivi‰
  ei korosteta, jos virhe sattuu olemaan objektikoodin ensimm‰isell‰ rivill‰. Joskus p‰‰ll‰‰n seisominen
  voi auttaa t‰h‰n pieneen, mutta kiusalliseen yksityiskohtaan. Pahoittelumme.</div>
 
  <br>
  <a name="selfcode"><b>Kysymys: Tein valtavan hienon ohjelman, joka sis‰lt‰‰ itse‰‰n muuttavaa
  koodia. Ensimm‰isen kerran ajettuani ohjelman, muuttunut koodi j‰i koodialueelle. Eih‰n oikeat
  koneet niin toimi? -Lyhyeen loppui koodi-ilottelu </b></a>
 <div> Valitettavasti Titokoneen versiossa 1.0 on bugi, jonka takia koodialuetta ei piirret‰ uudelleen. Itse‰‰n
  muuttanut koodi n‰kyy t‰st‰ syyst‰ v‰‰rin, vaikka se suorittuu oikein.</div>
 
 
 <br>
  <a name="chosen"><b>K‰‰nnˆs p‰‰ttyi virheeseen ensimm‰isell‰ kierroksella, mutta en p‰‰se
muokkaamaan koodia! Virheen aiheuttanut rivi pysyy valittuna. Yst‰v‰llisin terveisin, eritt‰in n‰rk‰stynyt!      </b></a>
  
  <div>Virheen aiheuttanut rivi pysyy valittuna. Virheen j‰lkeen Titokone n‰ytt‰‰ viel‰ virheeseen johtaneen
lopputilanteen. Kun painat jatka-nappia tai rivinvaihton‰pp‰int‰, k‰‰nnˆksest‰ siirryt‰‰n takaisin l‰hdekoodin‰kym‰‰n, jossa voit muokata koodia.</div>
  <br>
  <a name="paranoid"><b> Avasin useita l‰hdekooditiedostoja Titokoneessa, muokkasin niist‰
	paria ja nyt joku tiedostoista kirjoittui toisen p‰‰lle! Olenko
	paranoidi? -RaK
   </b></a>
   <div> Et ole, vaan eritt‰in ik‰v‰ bugi, jota emme Titokoneen versiosta 1.0
saaneet paikannettua, aiheuttaa joskus t‰llaisen ylikirjoittumisen.
Ongelman voi v‰ltt‰‰ muokkaamalla tiedostoja muualla (suuremmat
muokkaukset tulisi joka tapauksessa tehd‰ toisaalla) tai k‰sittelem‰ll‰
Titokoneella vain yht‰ tiedostoa kerrallaan. Pahoittelemme kovasti.
Laskuharjoitusten pit‰j‰lle voi n‰ytt‰‰ t‰m‰n osan k‰yttˆohjeesta,
mik‰li h‰n ei ota uskoakseen "Titokone sˆi kotiteht‰v‰ni!" -selityst‰si.
(T‰m‰ selitys todenn‰kˆisesti toimii vain kerran.)</div>


<br>

<a name="variable"><b>Saan k‰‰nnˆsvirheen "ep‰kelpo komento dc" (tai ds tai equ), kun k‰yt‰n
n‰hd‰kseni ihan oikein muotoa "muuttuja dc 333333333333333" -Kai Koksimies</b></a>
<div>Kun j‰lkimm‰inen luku on riitt‰v‰n pitk‰, k‰‰nt‰j‰ ei n‰e siin‰
kelvollista dc-komentoa (suurin mahdollinen luku DC:lle on 2^31-1, eli
2147483647), vaan yritt‰‰ tulkita komentoa muodossa "muistiviite komento
parametrit", mist‰ outo virheilmoitus johtuu. Virheilmoituksen
selvent‰minen on parannuslistalla Titokoneen seuraavaa versiota varten.</div>

<br><a name="animazion"><b> Kun klikkaan animointiasetuksen p‰‰lle, rivitt‰in suoritus menee
samalla myˆs p‰‰lle. En saa riveitt‰in suoritusta pois p‰‰lt‰ ilman,
ett‰ animointikin lakkaa. Miss‰ on vika?</b></a>
<div>Animoinnin seuraamisen helpottamiseksi ja synkronointiongelmia
v‰hent‰‰ksemme p‰‰timme, ett‰ animointi tehd‰‰n rivi kerrallaan. T‰st‰
syyst‰ riveitt‰in suorituksen asetus vaaditaan aina asetetuksi yhdess‰
animoinnin kanssa.</div>

<br>

<b><a name="R0">Rekisteri R0 eitoimi??? Latasin luvun 14 rekisteriin R0, nyt yrit‰n
    saada sen sielt‰ pois, mutta sielt‰ tulee vaan nollaa. Johtuuko t‰m‰ kahden komplementista?
    -M‰,lan </a></b>
<div>Johtuen TTK-91 m‰‰rittelyist‰, rekisterille R0 on varattu erikoismerkitys; sielt‰
 palautetaan aina arvo 0, vaikka sis‰ltˆ olisi eri. Pahoittelemme mahdollista sekaannusta.</div>
<br>
<a name="spfp"><b>Animointi-ikkunassa ei ole SP:t‰ eik‰ FP:t‰!</b></a>
<div>SP:n toinen nimi on R6 ja FP:n R7. Ne ovat animointi-ikkunassa t‰ll‰
nimell‰; tosin t‰m‰ voidaan muuttaa k‰‰nnˆstiedostoista tarvittaessa.</div>
<br>
<b><a name="help">Parannusehdotuksia, ongelmia?</a></b>
<div>Mik‰li kohtaamasi virhetilanne ei lˆytynyt t‰st‰, ole hyv‰ ja ilmoita
siit‰ esimerkiksi jollekin Tietokoneen toiminta -kurssin luennoijalle ja
pyyd‰ v‰litt‰m‰‰n viesti eteenp‰in. p.09-743 9685 (Tai joku muu yhteystieto joka
toimii.) Bugiraportteja otetaan myˆs vastaan.</div>

<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>

  
</body>
</html>
